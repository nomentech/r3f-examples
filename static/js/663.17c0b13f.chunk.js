"use strict";(self.webpackChunkr3f_examples=self.webpackChunkr3f_examples||[]).push([[663],{6663:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var i=n(2791),o=n(4647),a=n(2794),r=n(3433),c=n(4925),s=n(7462),l=n(3599),u=["follow","lockX","lockY","lockZ"],f=i.forwardRef((function(e,t){var n=e.follow,o=void 0===n||n,r=e.lockX,f=void 0!==r&&r,v=e.lockY,d=void 0!==v&&v,h=e.lockZ,m=void 0!==h&&h,p=(0,c.Z)(e,u),g=i.useRef();return(0,a.x)((function(e){var t=e.camera;if(o&&g.current){var n=g.current.rotation.clone();g.current.quaternion.copy(t.quaternion),f&&(g.current.rotation.x=n.x),d&&(g.current.rotation.y=n.y),m&&(g.current.rotation.z=n.z)}})),i.createElement("group",(0,s.Z)({ref:(0,l.Z)([g,t])},p))})),v=n(7459),d=n(9740),h=["opacity","speed","width","depth","segments","texture","color","depthTest"];function m(e){var t=e.opacity,n=void 0===t?.5:t,o=e.speed,s=void 0===o?.4:o,l=e.width,u=void 0===l?10:l,m=e.depth,p=void 0===m?1.5:m,g=e.segments,y=void 0===g?20:g,x=e.texture,E=void 0===x?"https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png":x,S=e.color,M=void 0===S?"#ffffff":S,w=e.depthTest,P=void 0===w||w,T=(0,c.Z)(e,h),b=(0,a.w)((function(e){return e.gl})),R=i.useRef(),z=(0,d.m)(E),C=i.useMemo((function(){return(0,r.Z)(new Array(y)).map((function(e,t){return{x:u/2-Math.random()*u,y:u/2-Math.random()*u,scale:.4+Math.sin((t+1)/y*Math.PI)*(10*(.2+Math.random())),density:Math.max(.2,Math.random()),rotation:Math.max(.002,.005*Math.random())*s}}))}),[u,y,s]);return(0,a.x)((function(e){var t;return null==(t=R.current)?void 0:t.children.forEach((function(t,n){t.children[0].rotation.z+=C[n].rotation,t.children[0].scale.setScalar(C[n].scale+(1+Math.sin(e.clock.getElapsedTime()/10))/2*n/10)}))})),i.createElement("group",T,i.createElement("group",{position:[0,0,y/2*p],ref:R},C.map((function(e,t){var o=e.x,a=e.y,r=e.scale,c=e.density;return i.createElement(f,{key:t,position:[o,a,-t*p]},i.createElement(v.JO,{scale:r,rotation:[0,0,0]},i.createElement("meshStandardMaterial",{map:z,"map-encoding":b.outputEncoding,transparent:!0,opacity:r/6*c*n,depthTest:P,color:M})))}))))}var p=n(4671),g=n(184),y=function(){var e=(0,a.w)().camera;return(0,a.x)((function(t){e.position.z=20*Math.sin(t.clock.elapsedTime)}))},x=function(e){var t=e.children;return(0,g.jsxs)(g.Fragment,{children:[t,(0,g.jsxs)(o.Xz,{camera:{position:[0,0,16],fov:75},children:[(0,g.jsx)("ambientLight",{intensity:.8}),(0,g.jsx)("pointLight",{intensity:2,position:[0,0,-1e3]}),(0,g.jsxs)(i.Suspense,{fallback:null,children:[(0,g.jsx)(m,{position:[-4,-2,-25],speed:.2,opacity:1}),(0,g.jsx)(m,{position:[4,2,-15],speed:.2,opacity:.5}),(0,g.jsx)(m,{position:[-4,2,-10],speed:.2,opacity:1}),(0,g.jsx)(m,{position:[4,-2,-5],speed:.2,opacity:.5}),(0,g.jsx)(m,{position:[4,2,0],speed:.2,opacity:.75})]}),(0,g.jsx)(p.q,{azimuth:.1,turbidity:10,rayleigh:.5,inclination:.6,distance:1e3}),(0,g.jsx)(y,{})]})]})}},4671:function(e,t,n){n.d(t,{q:function(){return m}});var i=n(9439),o=n(4925),a=n(7462),r=n(2791),c=n(3144),s=n(5671),l=n(136),u=n(9388),f=n(4942),v=n(7760),d=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,new v.BoxGeometry(1,1,1),n.material)}return(0,c.Z)(n)}(v.Mesh);(0,f.Z)(d,"SkyShader",{uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new v.Vector3},up:{value:new v.Vector3(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","void main() {","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( direction, vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","#include <tonemapping_fragment>","#include <encodings_fragment>","}"].join("\n")}),(0,f.Z)(d,"material",new v.ShaderMaterial({name:"SkyShader",fragmentShader:d.SkyShader.fragmentShader,vertexShader:d.SkyShader.vertexShader,uniforms:v.UniformsUtils.clone(d.SkyShader.uniforms),side:v.BackSide,depthWrite:!1}));var h=["inclination","azimuth","distance","mieCoefficient","mieDirectionalG","rayleigh","turbidity","sunPosition"];var m=r.forwardRef((function(e,t){var n=e.inclination,c=void 0===n?.6:n,s=e.azimuth,l=void 0===s?.1:s,u=e.distance,f=void 0===u?1e3:u,m=e.mieCoefficient,p=void 0===m?.005:m,g=e.mieDirectionalG,y=void 0===g?.8:g,x=e.rayleigh,E=void 0===x?.5:x,S=e.turbidity,M=void 0===S?10:S,w=e.sunPosition,P=void 0===w?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new v.Vector3,i=Math.PI*(e-.5),o=2*Math.PI*(t-.5);return n.x=Math.cos(o),n.y=Math.sin(i),n.z=Math.sin(o),n}(c,l):w,T=(0,o.Z)(e,h),b=r.useMemo((function(){return(new v.Vector3).setScalar(f)}),[f]),R=r.useState((function(){return new d})),z=(0,i.Z)(R,1)[0];return r.createElement("primitive",(0,a.Z)({object:z,ref:t,"material-uniforms-mieCoefficient-value":p,"material-uniforms-mieDirectionalG-value":y,"material-uniforms-rayleigh-value":E,"material-uniforms-sunPosition-value":P,"material-uniforms-turbidity-value":M,scale:b},T))}))},7459:function(e,t,n){n.d(t,{FC:function(){return l},JO:function(){return s}});var i=n(4925),o=n(7462),a=n(2791),r=["args","children"];function c(e){var t=e+"BufferGeometry";return a.forwardRef((function(e,n){var c=e.args,s=e.children,l=(0,i.Z)(e,r);return a.createElement("mesh",(0,o.Z)({ref:n},l),a.createElement(t,{attach:"geometry",args:c}),s)}))}c("box"),c("circle"),c("cone"),c("cylinder"),c("sphere");var s=c("plane"),l=(c("tube"),c("torus"),c("torusKnot"),c("tetrahedron"),c("ring"),c("polyhedron"),c("icosahedron"));c("octahedron"),c("dodecahedron"),c("extrude"),c("lathe")},9740:function(e,t,n){n.d(t,{m:function(){return s}});var i=n(4942),o=n(7760),a=n(2794),r=n(2791),c=function(e){return e===Object(e)&&!Array.isArray(e)&&"function"!==typeof e};function s(e){var t=(0,a.w)((function(e){return e.gl})),n=(0,a.z)(o.TextureLoader,c(e)?Object.values(e):e);if((0,r.useEffect)((function(){(Array.isArray(n)?n:[n]).forEach(t.initTexture)}),[t,n]),c(e)){var s=Object.keys(e),l={};return s.forEach((function(e){return Object.assign(l,(0,i.Z)({},e,n[s.indexOf(e)]))})),l}return n}s.preload=function(e){return a.z.preload(o.TextureLoader,e)},s.clear=function(e){return a.z.clear(o.TextureLoader,e)}}}]);
//# sourceMappingURL=663.17c0b13f.chunk.js.map