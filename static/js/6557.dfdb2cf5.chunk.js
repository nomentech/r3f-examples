"use strict";(self.webpackChunkr3f_examples=self.webpackChunkr3f_examples||[]).push([[6557],{3326:function(e,t,n){n.r(t),n.d(t,{default:function(){return K}});var r=n(1413),a=n(7760),o=n(4647),i=n(9058),s=n(9292),u=n(4637),c=n(2330),l=n(4671),d=n(3433),p=n(4925),f=n(2791),m=n(1690),h=n(2806),x=n(2194),y=n(1872),v=n.n(y),g=n(3144),_=n(5671),j=n(136),M=n(9388),w=function(e){(0,j.Z)(n,e);var t=(0,M.Z)(n);function n(e){return(0,_.Z)(this,n),t.call(this,n,(0,r.Z)({name:"GrassLayer"},e))}return(0,g.Z)(n)}(n(3847).$p);w.u_time=0,w.u_sway=.5,w.u_length=1,w.u_spherePos=new a.Vector3(0,0,0),w.u_noiseScale=10,w.u_noiseStrength=10,w.u_colorA=new a.Color("#ade266").convertSRGBToLinear(),w.u_colorB=new a.Color("#ade266").convertSRGBToLinear(),w.vertexShader="   \n    uniform float u_time;\n    uniform float u_sway;\n    uniform float u_length;\n    uniform vec3 u_spherePos;\n    varying vec3 v_pos;\n    \n    vec3 main() {\n      float cover = .25;\n      vec3 pos = position.xyz;\n      vec3 base = vec3(pos.x, pos.y, 0.0);\n      vec4 baseGP = instanceMatrix * vec4(base, 1.0);\n      v_pos = baseGP.xyz;\n      vec2 noise = (lamina_noise_curl(baseGP.xyz * vec3(0.1) + u_time * 0.5 * u_sway)).xy;\n      noise = smoothstep(-1.0, 1.0, noise);\n      float swingX = sin(u_time * 2.0 + noise.x * 2.0 * PI) * pow(pos.z, 2.0);\n      float swingY = cos(u_time * 2.0 + noise.y * 2.0 * PI) * pow(pos.z, 2.0);\n      float d = distance(u_spherePos, baseGP.xyz);\n      float radius = 0.75;\n      float intensity = (1. - min(d, radius) / radius) * 0.5;\n      pos.x += swingX + intensity;\n      pos.y += swingY + intensity;\n      return (pos * u_length);\n    }\n  ",w.fragmentShader="\n  varying vec3 v_pos;\n  uniform float u_noiseScale;\n  uniform float u_noiseStrength;\n  uniform vec3 u_colorA;\n  uniform vec3 u_colorB;\n\n  vec4 main() {\n    float n = lamina_noise_perlin(v_pos * u_noiseScale) * u_noiseStrength;\n    vec3 c =  mix(u_colorB, u_colorA, n);\n    return vec4(vec3(c), 1.);\n  }\n  ";var b=n(3655),A=n(9740),S=n.p+"static/media/flower.f6c9d4efe1c5c314b85d.glb",Z=n.p+"static/media/Albedo_2K__vkbgaihha.92ce073b39356436c650.jpg",P=n.p+"static/media/AO_2K__vkbgaihha.3efab155683a3795d697.jpg",R=n(184),T=(0,f.forwardRef)((function(e,t){var n=(0,b.L)(S).nodes,o=(0,A.m)(Z),i=(0,A.m)(P);return(0,R.jsx)("group",{children:(0,R.jsx)("instancedMesh",(0,r.Z)((0,r.Z)({ref:t,args:[void 0,void 0,1e3],castShadow:!0,receiveShadow:!0,geometry:n._ndyj_Var10_LOD0.geometry},e),{},{children:(0,R.jsxs)(x.ud,{lighting:"standard",side:a.DoubleSide,children:[(0,R.jsx)(x.xE,{map:o}),(0,R.jsx)(x.xE,{map:i,mode:"multiply"})]})}))})})),B=["children","strands"];function k(e){var t=e.children,n=e.strands,o=void 0===n?5e4:n,i=(0,p.Z)(e,B),s=(0,f.useRef)(),u=(0,f.useRef)(null),c=(0,f.useRef)(null),l=(0,f.useRef)();return(0,f.useEffect)((function(){u.current.geometry.applyMatrix4((new a.Matrix4).makeRotationX(Math.PI/2)),u.current.geometry.applyMatrix4((new a.Matrix4).makeTranslation(0,0,.5)),l.current.geometry.applyMatrix4((new a.Matrix4).makeRotationX(Math.PI/2)),l.current.geometry.applyMatrix4((new a.Matrix4).makeTranslation(0,0,.5))}),[]),(0,m.x)((function(){return c.current.time+=.005})),(0,R.jsxs)(R.Fragment,{children:[(0,f.cloneElement)(t,{ref:s}),(0,R.jsxs)("instancedMesh",(0,r.Z)((0,r.Z)({ref:u,args:[void 0,void 0,o]},i),{},{children:[(0,R.jsx)("coneGeometry",{args:[.05,1,2,20,!1,0,Math.PI]}),(0,R.jsxs)(x.ud,{side:a.DoubleSide,lighting:"standard",envMapIntensity:1,children:[(0,R.jsx)(x.HE,{colorA:"#221600",colorB:"#ade266",near:.14,far:1.52,mapping:"world"}),(0,R.jsx)("windLayer",{args:[{mode:"multiply"}],colorA:"#ffffff",colorB:"#acf5ce",noiseScale:10,noiseStrength:5,length:1.2,sway:.5,ref:c})]})]})),(0,R.jsx)(T,{ref:l}),(0,R.jsxs)("group",{children:[(0,R.jsx)(h.Z,{transform:function(e){var t=L(e),n=v().simplex3.apply(v(),(0,d.Z)(e.position.clone().multiplyScalar(5).toArray()));return t.scale.setScalar(.1*a.MathUtils.mapLinear(n,-1,1,.3,1)),t},mesh:s,instances:u}),(0,R.jsx)(h.Z,{transform:L,mesh:s,instances:l,weight:"density"})]})]})}v().seed(Math.random()),(0,m.e)({WindLayer:w});var L=function(e){var t=e.position,n=e.normal,r=e.dummy;return r.scale.setScalar(.0075*Math.random()),r.position.copy(t),r.lookAt(n.add(t)),r.rotation.y+=Math.random()-.5*Math.PI*.5,r.rotation.x+=Math.random()-.5*Math.PI*.5,r.rotation.z+=Math.random()-.5*Math.PI*.5,r.updateMatrix(),r},z=n(8015);v().seed(Math.random());var G=function(e){for(var t=e.getAttribute("position"),n=[],r=new a.Vector3,o=0;o<t.count;o++){r.fromBufferAttribute(t,o);var i=r.clone().multiplyScalar(1),s=v().simplex3.apply(v(),(0,d.Z)(i.toArray())),u=a.MathUtils.mapLinear(s,-1,1,0,1);u>.15&&(u=0),n.push(u)}return new a.Float32BufferAttribute(n,1)},I=(0,f.forwardRef)((function(e,t){var n=(0,f.useRef)();return(0,f.useEffect)((function(){for(var e=new a.Vector3,t=new a.Vector3,r=[],o=n.current.getAttribute("position"),i=n.current.getAttribute("normal"),s=0;s<o.count;s++){e.fromBufferAttribute(o,s),t.fromBufferAttribute(i,s);var u=e.multiplyScalar(.5),c=v().simplex3.apply(v(),(0,d.Z)(u.toArray()));e.add(t.multiplyScalar(.3*c)),r.push(e.x,e.y,e.z)}n.current.setAttribute("position",new a.Float32BufferAttribute(r,3)),n.current.attributes.position.needsUpdate=!0,n.current.computeVertexNormals()}),[]),(0,R.jsxs)("mesh",{ref:t,children:[(0,R.jsx)("icosahedronBufferGeometry",{args:[1.5,16],ref:n,children:(0,R.jsx)(z.E,{name:"density",compute:G,usage:a.StaticReadUsage})}),(0,R.jsx)("meshBasicMaterial",{color:"#221600"})]})})),E=n(9439),F=n(6483),U=n(3116),V=n(5215),X=n.p+"static/media/butterfly.3f53dd6fe916b2b0d066.glb",C=new a.Vector2;function D(e){var t=(0,f.useRef)(),n=(0,b.L)(X),o=n.scene,i=n.animations,s=(0,f.useMemo)((function(){return U.b.clone(o)}),[o]),u=(0,F.v)(i,t).actions,c=(0,f.useState)((function(){return new V.G({seed:Math.random()})})),l=(0,E.Z)(c,1)[0],d=(0,f.useState)((function(){return 100*Math.random()})),p=(0,E.Z)(d,1)[0];return(0,f.useEffect)((function(){u["ArmatureAction.001"].setEffectiveTimeScale(6);var e=setTimeout((function(){return u["ArmatureAction.001"].play()}),1e3*Math.random());return t.current.rotation.y=p,function(){var t;clearTimeout(e),null===(t=u["ArmatureAction.001"])||void 0===t||t.stop()}}),[]),(0,m.x)((function(e,n){var r=e.clock;C.set(r.elapsedTime,r.elapsedTime),t.current.position.set(0,l.get2(C),0),t.current.rotation.y-=n})),(0,R.jsx)("group",{ref:t,dispose:null,children:(0,R.jsx)("group",(0,r.Z)((0,r.Z)({},e),{},{children:(0,R.jsx)("group",{scale:.1,"rotation-y":Math.PI/4,"position-y":a.MathUtils.randFloat(-3,1),children:(0,R.jsx)("primitive",{object:s})})}))})}b.L.preload(X);var Y=Array.from({length:15},(function(){return{position:[a.MathUtils.randFloat(.5,.7),a.MathUtils.randFloat(.5,.7),a.MathUtils.randFloat(.5,.7)],scale:a.MathUtils.randFloat(.5,1)}})),q=function(){return(0,R.jsxs)("group",{children:[(0,R.jsx)(i.Z,{depthTest:!1,position:[-10,-6,-10],speed:.2,opacity:.4}),(0,R.jsx)(i.Z,{depthTest:!1,position:[10,6,-15],speed:.2,opacity:.25}),(0,R.jsx)(i.Z,{depthTest:!1,position:[0,10,0],speed:.2,opacity:.2}),(0,R.jsx)(i.Z,{depthTest:!1,position:[0,-10,0],speed:.2,opacity:.2}),(0,R.jsx)(i.Z,{depthTest:!1,position:[-10,-6,15],speed:.2,opacity:.3}),(0,R.jsx)(i.Z,{depthTest:!1,position:[10,6,10],speed:.2,opacity:.25})]})},K=function(e){var t=e.children;return(0,R.jsxs)(R.Fragment,{children:[t,(0,R.jsxs)(o.Xz,{dpr:1.5,camera:{position:[1,-1.25,1]},children:[(0,R.jsx)(k,{children:(0,R.jsx)(I,{})}),Y.map((function(e,t){return(0,R.jsx)(D,(0,r.Z)({},e),t)})),(0,R.jsx)(q,{}),(0,R.jsx)(s.qA,{preset:"sunset"}),(0,R.jsx)(u.z,{makeDefault:!0,autoRotate:!0,autoRotateSpeed:1.5}),(0,R.jsx)(c.i,{maxRoll:.2,maxPitch:.2,maxYaw:.2}),(0,R.jsx)(l.q,{})]})]})}}}]);
//# sourceMappingURL=6557.dfdb2cf5.chunk.js.map