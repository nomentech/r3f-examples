(self.webpackChunkr3f_examples=self.webpackChunkr3f_examples||[]).push([[2194],{2410:function(n){n.exports={"<<=":!0,">>=":!0,"++":!0,"--":!0,"+=":!0,"-=":!0,"*=":!0,"/=":!0,"%=":!0,"&=":!0,"^=":!0,"|=":!0,"=":!0}},9989:function(n){n.exports={precision:!0,highp:!0,mediump:!0,lowp:!0,attribute:!0,const:!0,uniform:!0,varying:!0,break:!0,continue:!0,do:!0,for:!0,while:!0,if:!0,else:!0,in:!0,out:!0,inout:!0,true:!0,false:!0,return:!0}},4989:function(n,e,t){var r=t(2410),o=t(9989);n.exports=function(n){for(var e=0,t=0;t<n.length;t++){var a=(l=n[t]).type;l.assignment=!1,l.declaration=!1,"ident"!==a&&"builtin"!==a||(e=t+1,s(1),"operator"===n[e].type&&r[n[e].data]&&(l.assignment=!0))}for(t=0;t<n.length;t++){var i=n[t],c=(a=i.type,i.data);if(i.declaration=!1,"keyword"===a){if(o[c])continue}else if("ident"!==a)continue;if(e=t+1,u(),"ident"===n[e].type)if(n[e++].declaration=!0,u(),"("!==n[e].data){for(;n[e]&&";"!==n[e].data;)","===n[e].data?(e++,s(1),(n[e].declaration="ident"===n[e].type)&&e++):(s(1),f(),s(1),e++);t=e}else{for(e++,s(1);n[e]&&")"!==n[e].data&&("keyword"===n[e].type||"ident"===n[e].type);)e++,s(1),"ident"===n[e].type&&(n[e++].declaration=!0,s(1),u(),s(1),","===n[e].data&&(e++,s(1)));t=e}}for(t=0;t<n.length;t++){var l;if("keyword"===(l=n[t]).type&&("struct"===l.data&&(e=t+1,s(1),"ident"===n[e].type&&(e++,s(1),"{"===n[e++].data)))){for(s(1);"ident"===n[e].type||"keyword"===n[e].type;){do{e++,s(1),n[e].structMember=!0,n[e].declaration=!1,e++,u()}while(","===n[e].data);";"===n[e].data&&e++,s()}if(e++,s(1),"ident"===n[e].type)for(n[e].declaration=!0,s(1);","===n[++e].data;)s(1),e++,s(1),"ident"===n[e].type&&(n[e].declaration=!0),s(1)}}return n;function s(t){for(;n[e]&&"whitespace"===n[e].type;)e++}function u(){for(;n[e]&&("integer"===n[e].type||"["===n[e].data||"]"===n[e].data||"whitespace"===n[e].type);)e++}function f(){if(n[e]&&"("===n[e].data){var t=0;do{if(";"===n[e].data)break;"("===n[e].data&&t++,")"===n[e].data&&t--}while(t&&n[++e])}}}},8847:function(n){n.exports=function(n){for(var e=!1,t=0,r=0;r<n.length;r++)switch(e=e||"keyword"===n[r].type&&"for"===n[r].data,n[r].data){case"(":n[r].depth=e?t++:t;break;case"{":n[r].depth=e?t:t++,e=!1;break;case"}":n[r].depth=--t;break;default:n[r].depth=t}for(r=0;r<n.length;r++){var o=n[r],a=r+1;if(("ident"===o.type||"keyword"===o.type)&&(i(),"ident"===n[a].type&&(i(),a++,"("===n[a].data))){for(;n[a]&&";"!==n[a].data&&"{"!==n[a].data;)n[a++].depth++;n[a]&&"{"===n[a].data&&n[a].depth++}}return n;function i(){for(;n[a]&&("whitespace"===n[a].type||"["===n[a].data||"]"===n[a].data||"integer"===n[a].data);)a++}}},1188:function(n,e,t){n.exports=function(n,e){t(8847)(n),t(1793)(n),t(2128)(n),t(4989)(n);for(var r=function(n){for(var e={},t=0;t<n.length;t++){var r=n[t];r.declaration&&(e[r.scope]=e[r.scope]||{},e[r.scope][r.data]=r)}return e}(n),o=e||function(){var n=0;return function(e){return e+"_"+(n++).toString(36)}}(),a={},i=0;i<n.length;i++){var c=n[i],l=c.stack,s=c.data;if(c.descoped=!1,"ident"===c.type&&!c.property&&!c.structMember){for(var u=!1,f=l.length-1;f>=0;f--){var d=r[l[f]];if(d&&d[s]){if(u=!0,f)break;c.descoped=c.data,c.data=a[s]=a[s]||o(s,c)||c.data}}u||(c.descoped=c.data,c.data=a[s]=a[s]||o(s,c)||c.data)}}return n}},3496:function(n){function e(n){return function(e){return"operator"===e.type&&(!n||e.data===n)}}function t(n){return"whitespace"!==n.type}n.exports=function(n){var r,o,a,i=null,c=null,l=0,s=0,u=0,f=0,d=0,p=[];for(r=0;r<n.length;r++)if("{"===(a=n[r]).data){if(l&&l++)continue;if((o=v(r,e(")"),e()))<0)continue;if(f=o,(o=v(o,e("("),e(")")))<0)continue;if(d=o,(o=v(o,t))<0)continue;if("ident"!==n[o].type)continue;if(c=n[o].data,(o=v(o,t))<0)continue;l=1,s=r,i=n[o].data,u=o;var m=v(o,t);switch(n[m]&&n[m].data){case"lowp":case"highp":case"mediump":u=m}}else if(l&&"}"===a.data){if(--l)continue;p.push({name:c,type:i,body:[s+1,r],args:[d,f+1],outer:[u,r+1]})}for(r=0;r<n.length;r++)if(";"===(a=n[r]).data){if((o=v(r,e(")"),e()))<0)continue;if(f=o,(o=v(o,e("("),e(")")))<0)continue;if(d=o,(o=v(o,t))<0)continue;if("ident"!==n[o].type)continue;if(c=n[o].data,(o=v(o,t))<0)continue;if("operator"===n[o].type)continue;if("return"===n[o].data)continue;i=n[o].data,p.push({name:c,type:i,body:!1,args:[d,f+1],outer:[o,r+1]})}return p.sort((function(n,e){return n.outer[0]-e.outer[0]}));function v(e,t,r){for(var o=e-1;o>=0;o--){if(t(n[o]))return o;if(r&&r(n[o]))return-1}return-1}}},2128:function(n){n.exports=function(n){for(var e=0;e<n.length;e++){var t=n[e];if(t.property=!1,"ident"===t.type){for(var r=e;n[--r]&&"whitespace"===n[r].type;);n[r]&&"operator"===n[r].type&&"."===n[r].data&&(t.property=!0)}}return n}},1793:function(n){n.exports=function(n){var e=[0],t=e[0],r=0;if(!n||!n.length)return n;if(!("depth"in n[0]))throw new Error("glsl-token-scope: No scope depth defined on tokens! Use glsl-token-depth on these tokens first");for(var o=0;o<n.length;o++){var a=n[o],i=a.depth;i>r?e.push(++t):i<r&&e.splice(-1,1),a.scope=e[e.length-1],a.stack=e.slice(),r=a.depth}return n}},7215:function(n){n.exports=function(n){for(var e=[],t=0;t<n.length;t++)"eof"!==n[t].type&&e.push(n[t].data);return e.join("")}},5001:function(n,e,t){n.exports=function(n){var e,t,f,d=0,p=0,m=l,v=[],h=[],g=1,y=0,_=0,x=!1,b=!1,w="",z=a,P=r;"300 es"===(n=n||{}).version&&(z=c,P=i);var S={},M={};for(d=0;d<z.length;d++)S[z[d]]=!0;for(d=0;d<P.length;d++)M[P[d]]=!0;return function(n){return h=[],null!==n?function(n){d=0,n.toString&&(n=n.toString());var t;w+=n.replace(/\r\n/g,"\n"),f=w.length;for(;e=w[d],d<f;){switch(t=d,m){case 0:d=k();break;case 1:d=D();break;case 2:d=C();break;case 3:d=A();break;case 4:d=Z();break;case 11:d=T();break;case 5:d=F();break;case s:d=L();break;case 9:d=j();break;case l:d=I()}if(t!==d)if("\n"===w[t])y=0,++g;else++y}return p+=d,w=w.slice(d),h}(n):function(n){v.length&&E(v.join(""));return m=10,E("(eof)"),h}()};function E(n){n.length&&h.push({type:u[m],data:n,position:_,line:g,column:y})}function I(){return v=v.length?[]:v,"/"===t&&"*"===e?(_=p+d-1,m=0,t=e,d+1):"/"===t&&"/"===e?(_=p+d-1,m=1,t=e,d+1):"#"===e?(m=2,_=p+d,d):/\s/.test(e)?(m=9,_=p+d,d):(x=/\d/.test(e),b=/[^\w_]/.test(e),_=p+d,m=x?4:b?3:s,d)}function j(){return/[^\s]/g.test(e)?(E(v.join("")),m=l,d):(v.push(e),t=e,d+1)}function C(){return"\r"!==e&&"\n"!==e||"\\"===t?(v.push(e),t=e,d+1):(E(v.join("")),m=l,d)}function D(){return C()}function k(){return"/"===e&&"*"===t?(v.push(e),E(v.join("")),m=l,d+1):(v.push(e),t=e,d+1)}function A(){if("."===t&&/\d/.test(e))return m=5,d;if("/"===t&&"*"===e)return m=0,d;if("/"===t&&"/"===e)return m=1,d;if("."===e&&v.length){for(;B(v););return m=5,d}if(";"===e||")"===e||"("===e){if(v.length)for(;B(v););return E(e),m=l,d+1}var n=2===v.length&&"="!==e;if(/[\w_\d\s]/.test(e)||n){for(;B(v););return m=l,d}return v.push(e),t=e,d+1}function B(n){for(var e,t,r=0;;){if(e=o.indexOf(n.slice(0,n.length+r).join("")),t=o[e],-1===e){if(r--+n.length>0)continue;t=n.slice(0,1).join("")}return E(t),_+=t.length,(v=v.slice(t.length)).length}}function T(){return/[^a-fA-F0-9]/.test(e)?(E(v.join("")),m=l,d):(v.push(e),t=e,d+1)}function Z(){return"."===e||/[eE]/.test(e)?(v.push(e),m=5,t=e,d+1):"x"===e&&1===v.length&&"0"===v[0]?(m=11,v.push(e),t=e,d+1):/[^\d]/.test(e)?(E(v.join("")),m=l,d):(v.push(e),t=e,d+1)}function F(){return"f"===e&&(v.push(e),t=e,d+=1),/[eE]/.test(e)?(v.push(e),t=e,d+1):("-"!==e&&"+"!==e||!/[eE]/.test(t))&&/[^\d]/.test(e)?(E(v.join("")),m=l,d):(v.push(e),t=e,d+1)}function L(){if(/[^\d\w_]/.test(e)){var n=v.join("");return m=M[n]?8:S[n]?7:6,E(v.join("")),m=l,d}return v.push(e),t=e,d+1}};var r=t(3826),o=t(4788),a=t(7261),i=t(1990),c=t(4742),l=999,s=9999,u=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},4742:function(n,e,t){var r=t(7261);r=r.slice().filter((function(n){return!/^(gl\_|texture)/.test(n)})),n.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},7261:function(n){n.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},1990:function(n,e,t){var r=t(3826);n.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},3826:function(n){n.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},4788:function(n){n.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},1886:function(n,e,t){var r=t(5001);n.exports=function(n,e){var t=r(e),o=[];return o=(o=o.concat(t(n))).concat(t(null))}},2194:function(n,e,t){"use strict";t.d(e,{HE:function(){return nn},YJ:function(){return tn},cy:function(){return en},ud:function(){return J},xE:function(){return rn}});var r=t(9439),o=t(8301),a=t(1120),i=t(136),c=t(9388),l=t(4942),s=t(1413),u=t(5671),f=t(3144),d=t(4925),p=(t(7757),t(7462)),m=t(1690),v=t(2791),h=t(3599),g=t(7760),y=t(1886),_=t.n(y),x=t(1188),b=t.n(x),w=t(7215),z=t.n(w),P=t(3496),S=t.n(P),M=t(5312),E=(t(1250),t(8075),["color","alpha","lighting","name"]),I=["label","options"],j=["color","alpha","lighting","layers","name"],C=["children"];function D(n){return"string"===typeof n?new g.Color(n).convertLinearToSRGB():n}function k(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.color,t=n.alpha,r=n.lighting,o=n.name,a=(0,d.Z)(n,E);return[{color:e,alpha:t,lighting:r,name:o},a]}function A(n){return n instanceof g.Vector3||n instanceof g.Vector2||n instanceof g.Vector4||n instanceof g.Matrix3||n instanceof g.Matrix4}function B(n){return A(n)?n.toArray():n instanceof g.Color?"#"+n.clone().convertLinearToSRGB().getHexString():n instanceof g.Texture?n.image.src:n}var T={normal:"normal",add:"add",subtract:"subtract",multiply:"multiply",lighten:"lighten",darken:"darken",divide:"divide",overlay:"overlay",screen:"screen",softlight:"softlight",negation:"negation",reflect:"reflect"},Z={perlin:"perlin",simplex:"simplex",cell:"cell",curl:"curl",white:"white"},F={local:"local",world:"world",uv:"uv"},L={phong:g.MeshPhongMaterial,physical:g.MeshPhysicalMaterial,toon:g.MeshToonMaterial,basic:g.MeshBasicMaterial,lambert:g.MeshLambertMaterial,standard:g.MeshStandardMaterial},K=function(){function n(e,t,r){var o=this;(0,u.Z)(this,n),this.uuid=g.MathUtils.generateUUID().replace(/-/g,"_"),this.name="LayerMaterial",this.mode="normal",this.visible=!0;var a=Object.getOwnPropertyNames(e).filter((function(n){return n.startsWith("u_")})).reduce((function(n,t){var r,o=null==(r=Object.getOwnPropertyDescriptor(e,t))?void 0:r.value;return(A(o)||o instanceof g.Color)&&(o=o.clone()),(0,s.Z)((0,s.Z)({},n),{},(0,l.Z)({},t.slice(1),o))}),{});for(var i in a){var c=i.split("_")[1];void 0!==(null==t?void 0:t[c])&&(a[i]=t[c])}t&&Object.keys(t).map((function(n){void 0!==t[n]&&(o[n]=t[n])})),this.uniforms={},this.schema=[];var f={};Object.keys(a).map((function(n){var e=n.split("_")[1];o.uniforms["u_".concat(o.uuid,"_").concat(e)]={value:D(a[n])},o.schema.push({value:a[n],label:e}),f[e]={set:function(n){o.uniforms["u_".concat(o.uuid,"_").concat(e)].value=D(n)},get:function(){return o.uniforms["u_".concat(o.uuid,"_").concat(e)].value}}})),null!=t&&t.name&&(this.name=t.name),null!=t&&t.mode&&(this.mode=t.mode),null!=t&&t.visible&&(this.visible=t.visible),Object.defineProperties(this,f),this.vertexShader="",this.fragmentShader="",this.vertexVariables="",this.fragmentVariables="",this.onParse=r,this.buildShaders(e),this.schema.push({value:this.mode,label:"mode",options:Object.values(T)}),this.schema.push({value:this.visible,label:"visible"})}return(0,f.Z)(n,[{key:"buildShaders",value:function(n){var e,t=this,r=Object.getOwnPropertyNames(n).filter((function(n){return"fragmentShader"===n||"vertexShader"===n})).reduce((function(e,t){var r;return(0,s.Z)((0,s.Z)({},e),{},(0,l.Z)({},t,null==(r=Object.getOwnPropertyDescriptor(n,t))?void 0:r.value))}),{}),o={vert:_()(r.vertexShader||""),frag:_()(r.fragmentShader||"")},a={vert:b()(o.vert,this.renameTokens.bind(this)),frag:b()(o.frag,this.renameTokens.bind(this))},i={vert:S()(a.vert),frag:S()(a.frag)},c=i.vert.map((function(n){return n.name})).indexOf("main"),u=i.frag.map((function(n){return n.name})).indexOf("main"),f={vert:c>=0?z()(a.vert.slice(0,i.vert[c].outer[0])):"",frag:u>=0?z()(a.frag.slice(0,i.frag[u].outer[0])):""},d={vert:c>=0?this.getShaderFromIndex(a.vert,i.vert[c].body):"",frag:u>=0?this.getShaderFromIndex(a.frag,i.frag[u].body):""};this.vertexShader=this.processFinal(d.vert,!0),this.fragmentShader=this.processFinal(d.frag),this.vertexVariables=f.vert,this.fragmentVariables=f.frag,null==(e=this.onParse)||e.call(this,this),this.schema=this.schema.filter((function(n,e){var r=n.label;return e===t.schema.findIndex((function(n){return n.label===r}))}))}},{key:"renameTokens",value:function(n){if(n.startsWith("u_")){var e=n.slice(2);return"u_".concat(this.uuid,"_").concat(e)}if(n.startsWith("v_")){var t=n.slice(2);return"v_".concat(this.uuid,"_").concat(t)}if(n.startsWith("f_")){var r=n.slice(2);return"f_".concat(this.uuid,"_").concat(r)}return n}},{key:"processFinal",value:function(n,e){var t=n.replace(/\sf_/gm," f_".concat(this.uuid,"_")).replace(/\(f_/gm,"(f_".concat(this.uuid,"_")),r=t.match(/^.*return.*$/gm),o=t.replace(/^.*return.*$/gm,"");if(null!=r&&r[0]){var a=r[0].replace("return","").trim().replace(";",""),i=this.getBlendMode(a,"lamina_finalColor");o+=e?"lamina_finalPosition = ".concat(a,";"):"lamina_finalColor = ".concat(i,";")}return o}},{key:"getShaderFromIndex",value:function(n,e){return z()(n.slice(e[0],e[1]))}},{key:"getBlendMode",value:function(n,e){switch(this.mode){default:case"normal":return"lamina_blend_alpha(".concat(e,", ").concat(n,", ").concat(n,".a)");case"add":return"lamina_blend_add(".concat(e,", ").concat(n,", ").concat(n,".a)");case"subtract":return"lamina_blend_subtract(".concat(e,", ").concat(n,", ").concat(n,".a)");case"multiply":return"lamina_blend_multiply(".concat(e,", ").concat(n,", ").concat(n,".a)");case"lighten":return"lamina_blend_lighten(".concat(e,", ").concat(n,", ").concat(n,".a)");case"darken":return"lamina_blend_darken(".concat(e,", ").concat(n,", ").concat(n,".a)");case"divide":return"lamina_blend_divide(".concat(e,", ").concat(n,", ").concat(n,".a)");case"overlay":return"lamina_blend_overlay(".concat(e,", ").concat(n,", ").concat(n,".a)");case"screen":return"lamina_blend_screen(".concat(e,", ").concat(n,", ").concat(n,".a)");case"softlight":return"lamina_blend_softlight(".concat(e,", ").concat(n,", ").concat(n,".a)");case"reflect":return"lamina_blend_reflect(".concat(e,", ").concat(n,", ").concat(n,".a)");case"negation":return"lamina_blend_negation(".concat(e,", ").concat(n,", ").concat(n,".a)")}}},{key:"getSchema",value:function(){var n=this;return this.schema.map((function(e){var t=e.label,r=e.options,o=(0,d.Z)(e,I);return(0,s.Z)((0,s.Z)((0,s.Z)({label:t,options:r},function(n){switch(n){case"alpha":return{min:0,max:1};case"scale":return{min:0};case"map":return{image:void 0};default:return{}}}(t)),o),{},{value:B(n[t])})}))}},{key:"serialize",value:function(){var n=this,e=this.constructor.name.split("$")[0],t=Object.keys(this);t=t.filter((function(n){return!["uuid","uniforms","schema","fragmentShader","vertexShader","fragmentVariables","vertexVariables","attribs","events","__r3f","onParse"].includes(n)}));var r={};t.forEach((function(e){r[e]=n[e]}));var o={};for(var a in this.uniforms){o[a.replace("u_".concat(this.uuid,"_"),"")]=B(this.uniforms[a].value)}return{constructor:e,properties:(0,s.Z)((0,s.Z)({},o),r)}}}]),n}(),U=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){var r;return(0,u.Z)(this,t),(r=e.call(this,t,(0,s.Z)({name:"Depth"},n),(function(n){n.schema.push({value:n.mapping,label:"mapping",options:["vector","world","camera"]});var e=t.getMapping(n.uuid,n.mapping);n.fragmentShader=n.fragmentShader.replace("lamina_mapping_template",e)}))).mapping="vector",r}return(0,f.Z)(t,null,[{key:"getMapping",value:function(n,e){switch(e){default:case"vector":return"length(v_".concat(n,"_worldPosition - u_").concat(n,"_origin)");case"world":return"length(v_".concat(n,"_position - vec3(0.))");case"camera":return"length(v_".concat(n,"_worldPosition - cameraPosition)")}}}]),t}(K);U.u_near=2,U.u_far=10,U.u_origin=new g.Vector3(0,0,0),U.u_colorA="white",U.u_colorB="black",U.u_alpha=1,U.vertexShader="\n  varying vec3 v_worldPosition;\n  varying vec3 v_position;\n\n  void main() {\n    v_worldPosition = (vec4(position, 1.0) * modelMatrix).xyz;\n    v_position = position;\n  }\n  ",U.fragmentShader="   \n    uniform float u_alpha;\n    uniform float u_near;\n    uniform float u_far;\n    uniform float u_isVector;\n    uniform vec3 u_origin;\n    uniform vec3 u_colorA;\n    uniform vec3 u_colorB;\n\n    varying vec3 v_worldPosition;\n    varying vec3 v_position;\n\n    void main() {\n      float f_dist = lamina_mapping_template;\n      float f_depth = (f_dist - u_near) / (u_far - u_near);\n\t\t\tvec3 f_depthColor =  mix(u_colorB, u_colorA, 1.0 - clamp(f_depth, 0., 1.));\n  \n  \n      return vec4(f_depthColor, u_alpha);\n    }\n  ";var N=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){return(0,u.Z)(this,t),e.call(this,t,(0,s.Z)({name:"Color"},n))}return(0,f.Z)(t)}(K);N.u_color="red",N.u_alpha=1,N.fragmentShader="   \n    uniform vec3 u_color;\n    uniform float u_alpha;\n\n    void main() {\n      return vec4(u_color, u_alpha);\n    }\n  ";var V=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){var r;return(0,u.Z)(this,t),(r=e.call(this,t,(0,s.Z)({name:"noise"},n),(function(n){n.schema.push({value:n.type,label:"type",options:Object.values(Z)}),n.schema.push({value:n.mapping,label:"mapping",options:Object.values(F)});var e=t.getNoiseFunction(n.type),r=t.getMapping(n.mapping);n.vertexShader=n.vertexShader.replace("lamina_mapping_template",r),n.fragmentShader=n.fragmentShader.replace("lamina_noise_template",e)}))).type="perlin",r.mapping="local",r}return(0,f.Z)(t,null,[{key:"getNoiseFunction",value:function(n){switch(n){default:case"perlin":return"lamina_noise_perlin";case"simplex":return"lamina_noise_simplex";case"cell":return"lamina_noise_worley";case"white":return"lamina_noise_white";case"curl":return"lamina_noise_swirl"}}},{key:"getMapping",value:function(n){switch(n){default:case"local":return"position";case"world":return"(modelMatrix * vec4(position,1.0)).xyz";case"uv":return"vec3(uv, 0.)"}}}]),t}(K);V.u_colorA="#666666",V.u_colorB="#666666",V.u_colorC="#FFFFFF",V.u_colorD="#FFFFFF",V.u_alpha=1,V.u_scale=1,V.u_offset=new g.Vector3(0,0,0),V.vertexShader="\n    varying vec3 v_position;\n\n    void main() {\n        v_position = lamina_mapping_template;\n    }\n  ",V.fragmentShader="   \n    uniform vec3 u_colorA;\n    uniform vec3 u_colorB;\n    uniform vec3 u_colorC;\n    uniform vec3 u_colorD;\n    uniform vec3 u_offset;\n\n    uniform float u_alpha;\n    uniform float u_scale;\n\n    varying vec3 v_position;\n\n\n    void main() {\n        float f_n = lamina_noise_template((v_position + u_offset) * u_scale);\n\n        float f_step1 = 0.;\n        float f_step2 = 0.2;\n        float f_step3 = 0.6;\n        float f_step4 = 1.;\n\n        vec3 f_color = mix(u_colorA, u_colorB, smoothstep(f_step1, f_step2, f_n));\n        f_color = mix(f_color, u_colorC, smoothstep(f_step2, f_step3, f_n));\n        f_color = mix(f_color, u_colorD, smoothstep(f_step3, f_step4, f_n));\n\n        return vec4(f_color, u_alpha);\n    }\n  ";var O=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){return(0,u.Z)(this,t),e.call(this,t,(0,s.Z)({name:"Fresnel"},n))}return(0,f.Z)(t)}(K);O.u_color="white",O.u_alpha=1,O.u_bias=0,O.u_intensity=1,O.u_power=2,O.u_factor=1,O.vertexShader="\n    varying vec3 v_worldPosition;\n    varying vec3 v_worldNormal;\n\n    void main() {\n        v_worldPosition = vec3(-viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2]);\n        v_worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );\n        \n    }\n  ",O.fragmentShader="   \n    uniform vec3 u_color;\n    uniform float u_alpha;\n    uniform float u_bias;\n    uniform float u_intensity;\n    uniform float u_power;\n    uniform float u_factor;\n\n    varying vec3 v_worldPosition;\n    varying vec3 v_worldNormal;\n\n    void main() {\n        float f_a = (u_factor  + dot(v_worldPosition, v_worldNormal));\n        float f_fresnel = u_bias + u_intensity * pow(abs(f_a), u_power);\n\n        f_fresnel = clamp(f_fresnel, 0.0, 1.0);\n        return vec4(f_fresnel * u_color, u_alpha);\n    }\n  ";var R=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){var r;return(0,u.Z)(this,t),(r=e.call(this,t,(0,s.Z)({name:"Gradient"},n),(function(n){n.schema.push({value:n.axes,label:"axes",options:["x","y","z"]}),n.schema.push({value:n.mapping,label:"mapping",options:Object.values(F)});var e=t.getMapping(n.mapping);n.vertexShader=n.vertexShader.replace("lamina_mapping_template",e||"local"),n.fragmentShader=n.fragmentShader.replace("axes_template",n.axes||"x")}))).axes="x",r.mapping="local",r}return(0,f.Z)(t,null,[{key:"getMapping",value:function(n){switch(n){default:case"local":return"position";case"world":return"(modelMatrix * vec4(position,1.0)).xyz";case"uv":return"vec3(uv, 0.)"}}}]),t}(K);R.u_colorA="white",R.u_colorB="black",R.u_alpha=1,R.u_start=1,R.u_end=-1,R.u_contrast=1,R.vertexShader="\n\t\tvarying vec3 v_position;\n\n\t\tvod main() {\n      v_position = lamina_mapping_template;\n\t\t}\n  ",R.fragmentShader="   \n    uniform vec3 u_colorA;\n    uniform vec3 u_colorB;\n    uniform vec3 u_axis;\n    uniform float u_alpha;\n    uniform float u_start;\n    uniform float u_end;\n    uniform float u_contrast;\n\n\t\tvarying vec3 v_position;\n\n    void main() {\n\n      float f_step = smoothstep(u_start, u_end, v_position.axes_template * u_contrast);\n      vec3 f_color = mix(u_colorA, u_colorB, f_step);\n\n      return vec4(f_color, u_alpha);\n    }\n  ";var Y=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){return(0,u.Z)(this,t),e.call(this,t,(0,s.Z)({name:"Matcap"},n))}return(0,f.Z)(t)}(K);Y.u_alpha=1,Y.u_map=void 0,Y.vertexShader="\n    varying vec3 v_position;\n    varying vec3 v_normal;\n    \n    void main() {\n      v_position = normalize( vec3( modelViewMatrix * vec4( position, 1.0 ) ) );\n      v_normal = normalize( normalMatrix * normal );\n    }\n    ",Y.fragmentShader=" \n\t\tuniform sampler2D u_map;  \n\t\tuniform float u_alpha;  \n\t\tvarying vec3 v_position;\n\t\tvarying vec3 v_normal;\n\n\t\t\n    void main() {\n\t\t\tvec3 f_r = reflect( v_position, v_normal );\n\t\t\tfloat f_m = 2. * sqrt( pow( f_r.x, 2. ) + pow( f_r.y, 2. ) + pow( f_r.z + 1., 2. ) );\n\t\t\tvec2 f_vN = f_r.xy / f_m + .5;\n\n\t\t\tvec3 f_base = texture2D(u_map, f_vN).rgb;\n\n      return vec4(f_base, u_alpha);\n    }\n  ";var q=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){return(0,u.Z)(this,t),e.call(this,t,(0,s.Z)({name:"Texture"},n))}return(0,f.Z)(t)}(K);q.u_alpha=1,q.u_map=void 0,q.vertexShader="\n    varying vec2 v_uv;\n    \n    void main() {\n        v_uv = uv;\n    }\n    ",q.fragmentShader=" \n\t\tuniform sampler2D u_map;  \n\t\tuniform float u_alpha;  \n\t\tvarying vec2 v_uv;\n\n    void main() {\n\t\t\tvec4 f_color = texture2D(u_map, v_uv);\n      return vec4(f_color.rgb, f_color.a * u_alpha);\n    }\n  ";var W=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){var r;return(0,u.Z)(this,t),(r=e.call(this,t,(0,s.Z)({name:"Displace"},n),(function(n){n.schema.push({value:n.type,label:"type",options:Object.values(Z)}),n.schema.push({value:n.mapping,label:"mapping",options:Object.values(F)});var e=t.getNoiseFunction(n.type),r=t.getMapping(n.mapping);n.vertexVariables=n.vertexVariables.replace("lamina_mapping_template",r),n.vertexVariables=n.vertexVariables.replace("lamina_noise_template",e)}))).type="perlin",r.mapping="local",r}return(0,f.Z)(t,null,[{key:"getNoiseFunction",value:function(n){switch(n){default:case"perlin":return"lamina_noise_perlin";case"simplex":return"lamina_noise_simplex";case"cell":return"lamina_noise_worley";case"white":return"lamina_noise_white";case"curl":return"lamina_noise_swirl"}}},{key:"getMapping",value:function(n){switch(n){default:case"local":return"p";case"world":return"(modelMatrix * vec4(p,1.0)).xyz";case"uv":return"vec3(uv, 0.)"}}}]),t}(K);W.u_strength=1,W.u_scale=1,W.u_offset=new g.Vector3(0,0,0),W.vertexShader="\n       \n      uniform float u_strength;\n      uniform float u_scale;\n      uniform vec3 u_offset;\n\n      vec3 displace(vec3 p) {\n\t\t\t\tvec3 f_position = lamina_mapping_template;\n        float f_n = lamina_noise_template((f_position + u_offset) * u_scale) * u_strength;\n        vec3 f_newPosition = p + (f_n * normal);\n\n\t\t\t\treturn f_newPosition;\n      }\n\n      \n\t\t\tvec3 orthogonal(vec3 v) {\n  \t\t  return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0)\n  \t\t  : vec3(0.0, -v.z, v.y));\n  \t\t}\n  \t\tvec3 recalcNormals(vec3 newPos) {\n  \t\t  float offset = 0.001;\n  \t\t  vec3 tangent = orthogonal(normal);\n  \t\t  vec3 bitangent = normalize(cross(normal, tangent));\n  \t\t  vec3 neighbour1 = position + tangent * offset;\n  \t\t  vec3 neighbour2 = position + bitangent * offset;\n  \t\t  vec3 displacedNeighbour1 = displace(neighbour1);\n  \t\t  vec3 displacedNeighbour2 = displace(neighbour2);\n  \t\t  vec3 displacedTangent = displacedNeighbour1 - newPos;\n  \t\t  vec3 displacedBitangent = displacedNeighbour2 - newPos;\n  \t\t  return normalize(cross(displacedTangent, displacedBitangent));\n  \t\t}\n  \n  \n      void main() {\n       \n\t\t\t\tvec3 f_newPosition = displace(position);\n        lamina_finalNormal = recalcNormals(f_newPosition);\n\n        return f_newPosition;\n      }\n    ";var G=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(n){return(0,u.Z)(this,t),e.call(this,t,(0,s.Z)({name:"Normal"},n))}return(0,f.Z)(t)}(K);G.u_alpha=1,G.u_direction=new g.Vector3(1,1,1),G.vertexShader="   \n  varying vec3 v_normals; \n\n  void main() {\n    v_normals = normal;\n  }\n",G.fragmentShader="   \n  \tuniform float u_alpha;\n  \tuniform vec3 u_color;\n  \tuniform vec3 u_direction;\n\n\t\tvarying vec3 v_normals;\n\n    void main() {\n\t\t\tvec3 f_normalColor = vec3(1.);\n      f_normalColor.x = v_normals.x * u_direction.x;\n      f_normalColor.y = v_normals.y * u_direction.y;\n      f_normalColor.z = v_normals.z * u_direction.z;\n\n      return vec4(f_normalColor, u_alpha);\n    }\n  ";var X="\n\n// From: https://gist.github.com/patriciogonzalezvivo/670c22f3966e662d2f83\n// Huge thanks to the creators of these algorithms\n\nfloat lamina_noise_mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 lamina_noise_mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 lamina_noise_perm(vec4 x){return lamina_noise_mod289(((x * 34.0) + 1.0) * x);}\nvec4 lamina_noise_permute(vec4 x) { return mod(((x * 34.0) + 1.0) * x, 289.0); }\nvec4 lamina_noise_taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }\n\n\nfloat lamina_noise_white(vec2 p) {\n  return fract(1e4 * sin(17.0 * p.x + p.y * 0.1) *\n               (0.1 + abs(sin(p.y * 13.0 + p.x))));\n}\n\nfloat lamina_noise_white(vec3 p) {\n  return lamina_noise_white(p.xy);\n}\n\n\nvec3 lamina_noise_fade(vec3 t) { return t * t * t * (t * (t * 6.0 - 15.0) + 10.0); }\n\nfloat lamina_noise_perlin(vec3 P) {\n  vec3 Pi0 = floor(P);        // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod(Pi0, 289.0);\n  Pi1 = mod(Pi1, 289.0);\n  vec3 Pf0 = fract(P);        // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = lamina_noise_permute(lamina_noise_permute(ix) + iy);\n  vec4 ixy0 = lamina_noise_permute(ixy + iz0);\n  vec4 ixy1 = lamina_noise_permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 / 7.0;\n  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 / 7.0;\n  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n  vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n  vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n  vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n  vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n  vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n  vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n  vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n\n  vec4 norm0 = lamina_noise_taylorInvSqrt(\n      vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = lamina_noise_taylorInvSqrt(\n      vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = lamina_noise_fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111),\n                 fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return lamina_normalize(2.2 * n_xyz);\n}\n\nfloat lamina_noise_simplex(vec3 v) {\n  const vec2 C = vec2(1.0 / 6.0, 1.0 / 3.0);\n  const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  // First corner\n  vec3 i = floor(v + dot(v, C.yyy));\n  vec3 x0 = v - i + dot(i, C.xxx);\n\n  // Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min(g.xyz, l.zxy);\n  vec3 i2 = max(g.xyz, l.zxy);\n\n  //  x0 = x0 - 0. + 0.0 * C\n  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n  // Permutations\n  i = mod(i, 289.0);\n  vec4 p = lamina_noise_permute(lamina_noise_permute(lamina_noise_permute(i.z + vec4(0.0, i1.z, i2.z, 1.0)) + i.y +\n                             vec4(0.0, i1.y, i2.y, 1.0)) +\n                    i.x + vec4(0.0, i1.x, i2.x, 1.0));\n\n  // Gradients\n  // ( N*N points uniformly over a square, mapped onto an octahedron.)\n  float n_ = 1.0 / 7.0; // N=7\n  vec3 ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z); //  mod(p,N*N)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_); // mod(j,N)\n\n  vec4 x = x_ * ns.x + ns.yyyy;\n  vec4 y = y_ * ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4(x.xy, y.xy);\n  vec4 b1 = vec4(x.zw, y.zw);\n\n  vec4 s0 = floor(b0) * 2.0 + 1.0;\n  vec4 s1 = floor(b1) * 2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;\n  vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;\n\n  vec3 p0 = vec3(a0.xy, h.x);\n  vec3 p1 = vec3(a0.zw, h.y);\n  vec3 p2 = vec3(a1.xy, h.z);\n  vec3 p3 = vec3(a1.zw, h.w);\n\n  // Normalise gradients\n  vec4 norm =\n      lamina_noise_taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  // Mix final noise value\n  vec4 m =\n      max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);\n  m = m * m;\n  return lamina_normalize(42.0 *\n         dot(m * m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3))));\n}\n\nvec3 lamina_noise_simplex3(vec3 x) {\n  float s = lamina_noise_simplex(vec3(x));\n  float s1 = lamina_noise_simplex(vec3(x.y - 19.1, x.z + 33.4, x.x + 47.2));\n  float s2 = lamina_noise_simplex(vec3(x.z + 74.2, x.x - 124.5, x.y + 99.4));\n  vec3 c = vec3(s, s1, s2);\n  return c;\n}\n\nvec3 lamina_noise_curl(vec3 p) {\n  const float e = .1;\n  vec3 dx = vec3(e, 0.0, 0.0);\n  vec3 dy = vec3(0.0, e, 0.0);\n  vec3 dz = vec3(0.0, 0.0, e);\n\n  vec3 p_x0 = lamina_noise_simplex3(p - dx);\n  vec3 p_x1 = lamina_noise_simplex3(p + dx);\n  vec3 p_y0 = lamina_noise_simplex3(p - dy);\n  vec3 p_y1 = lamina_noise_simplex3(p + dy);\n  vec3 p_z0 = lamina_noise_simplex3(p - dz);\n  vec3 p_z1 = lamina_noise_simplex3(p + dz);\n\n  float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n  float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n  float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n\n  const float divisor = 1.0 / (2.0 * e);\n  return normalize(vec3(x, y, z) * divisor);\n}\n\nvec3 lamina_permute(vec3 x) {\n  return mod((34.0 * x + 1.0) * x, 289.0);\n}\n\nvec3 lamina_dist(vec3 x, vec3 y, vec3 z,  bool manhattanDistance) {\n  return manhattanDistance ?  abs(x) + abs(y) + abs(z) :  (x * x + y * y + z * z);\n}\n\n// From: https://github.com/Erkaman/glsl-worley\nfloat lamina_noise_worley(vec3 P) {\n  float jitter = 1.;\n  bool manhattanDistance = false; \n\n  float K = 0.142857142857; // 1/7\n  float Ko = 0.428571428571; // 1/2-K/2\n  float  K2 = 0.020408163265306; // 1/(7*7)\n  float Kz = 0.166666666667; // 1/6\n  float Kzo = 0.416666666667; // 1/2-1/6*2\n\n\tvec3 Pi = mod(floor(P), 289.0);\n \tvec3 Pf = fract(P) - 0.5;\n\n\tvec3 Pfx = Pf.x + vec3(1.0, 0.0, -1.0);\n\tvec3 Pfy = Pf.y + vec3(1.0, 0.0, -1.0);\n\tvec3 Pfz = Pf.z + vec3(1.0, 0.0, -1.0);\n\n\tvec3 p = lamina_permute(Pi.x + vec3(-1.0, 0.0, 1.0));\n\tvec3 p1 = lamina_permute(p + Pi.y - 1.0);\n\tvec3 p2 = lamina_permute(p + Pi.y);\n\tvec3 p3 = lamina_permute(p + Pi.y + 1.0);\n\n\tvec3 p11 = lamina_permute(p1 + Pi.z - 1.0);\n\tvec3 p12 = lamina_permute(p1 + Pi.z);\n\tvec3 p13 = lamina_permute(p1 + Pi.z + 1.0);\n\n\tvec3 p21 = lamina_permute(p2 + Pi.z - 1.0);\n\tvec3 p22 = lamina_permute(p2 + Pi.z);\n\tvec3 p23 = lamina_permute(p2 + Pi.z + 1.0);\n\n\tvec3 p31 = lamina_permute(p3 + Pi.z - 1.0);\n\tvec3 p32 = lamina_permute(p3 + Pi.z);\n\tvec3 p33 = lamina_permute(p3 + Pi.z + 1.0);\n\n\tvec3 ox11 = fract(p11*K) - Ko;\n\tvec3 oy11 = mod(floor(p11*K), 7.0)*K - Ko;\n\tvec3 oz11 = floor(p11*K2)*Kz - Kzo; // p11 < 289 guaranteed\n\n\tvec3 ox12 = fract(p12*K) - Ko;\n\tvec3 oy12 = mod(floor(p12*K), 7.0)*K - Ko;\n\tvec3 oz12 = floor(p12*K2)*Kz - Kzo;\n\n\tvec3 ox13 = fract(p13*K) - Ko;\n\tvec3 oy13 = mod(floor(p13*K), 7.0)*K - Ko;\n\tvec3 oz13 = floor(p13*K2)*Kz - Kzo;\n\n\tvec3 ox21 = fract(p21*K) - Ko;\n\tvec3 oy21 = mod(floor(p21*K), 7.0)*K - Ko;\n\tvec3 oz21 = floor(p21*K2)*Kz - Kzo;\n\n\tvec3 ox22 = fract(p22*K) - Ko;\n\tvec3 oy22 = mod(floor(p22*K), 7.0)*K - Ko;\n\tvec3 oz22 = floor(p22*K2)*Kz - Kzo;\n\n\tvec3 ox23 = fract(p23*K) - Ko;\n\tvec3 oy23 = mod(floor(p23*K), 7.0)*K - Ko;\n\tvec3 oz23 = floor(p23*K2)*Kz - Kzo;\n\n\tvec3 ox31 = fract(p31*K) - Ko;\n\tvec3 oy31 = mod(floor(p31*K), 7.0)*K - Ko;\n\tvec3 oz31 = floor(p31*K2)*Kz - Kzo;\n\n\tvec3 ox32 = fract(p32*K) - Ko;\n\tvec3 oy32 = mod(floor(p32*K), 7.0)*K - Ko;\n\tvec3 oz32 = floor(p32*K2)*Kz - Kzo;\n\n\tvec3 ox33 = fract(p33*K) - Ko;\n\tvec3 oy33 = mod(floor(p33*K), 7.0)*K - Ko;\n\tvec3 oz33 = floor(p33*K2)*Kz - Kzo;\n\n\tvec3 dx11 = Pfx + jitter*ox11;\n\tvec3 dy11 = Pfy.x + jitter*oy11;\n\tvec3 dz11 = Pfz.x + jitter*oz11;\n\n\tvec3 dx12 = Pfx + jitter*ox12;\n\tvec3 dy12 = Pfy.x + jitter*oy12;\n\tvec3 dz12 = Pfz.y + jitter*oz12;\n\n\tvec3 dx13 = Pfx + jitter*ox13;\n\tvec3 dy13 = Pfy.x + jitter*oy13;\n\tvec3 dz13 = Pfz.z + jitter*oz13;\n\n\tvec3 dx21 = Pfx + jitter*ox21;\n\tvec3 dy21 = Pfy.y + jitter*oy21;\n\tvec3 dz21 = Pfz.x + jitter*oz21;\n\n\tvec3 dx22 = Pfx + jitter*ox22;\n\tvec3 dy22 = Pfy.y + jitter*oy22;\n\tvec3 dz22 = Pfz.y + jitter*oz22;\n\n\tvec3 dx23 = Pfx + jitter*ox23;\n\tvec3 dy23 = Pfy.y + jitter*oy23;\n\tvec3 dz23 = Pfz.z + jitter*oz23;\n\n\tvec3 dx31 = Pfx + jitter*ox31;\n\tvec3 dy31 = Pfy.z + jitter*oy31;\n\tvec3 dz31 = Pfz.x + jitter*oz31;\n\n\tvec3 dx32 = Pfx + jitter*ox32;\n\tvec3 dy32 = Pfy.z + jitter*oy32;\n\tvec3 dz32 = Pfz.y + jitter*oz32;\n\n\tvec3 dx33 = Pfx + jitter*ox33;\n\tvec3 dy33 = Pfy.z + jitter*oy33;\n\tvec3 dz33 = Pfz.z + jitter*oz33;\n\n\tvec3 d11 = lamina_dist(dx11, dy11, dz11, manhattanDistance);\n\tvec3 d12 = lamina_dist(dx12, dy12, dz12, manhattanDistance);\n\tvec3 d13 = lamina_dist(dx13, dy13, dz13, manhattanDistance);\n\tvec3 d21 = lamina_dist(dx21, dy21, dz21, manhattanDistance);\n\tvec3 d22 = lamina_dist(dx22, dy22, dz22, manhattanDistance);\n\tvec3 d23 = lamina_dist(dx23, dy23, dz23, manhattanDistance);\n\tvec3 d31 = lamina_dist(dx31, dy31, dz31, manhattanDistance);\n\tvec3 d32 = lamina_dist(dx32, dy32, dz32, manhattanDistance);\n\tvec3 d33 = lamina_dist(dx33, dy33, dz33, manhattanDistance);\n\n\tvec3 d1a = min(d11, d12);\n\td12 = max(d11, d12);\n\td11 = min(d1a, d13); // Smallest now not in d12 or d13\n\td13 = max(d1a, d13);\n\td12 = min(d12, d13); // 2nd smallest now not in d13\n\tvec3 d2a = min(d21, d22);\n\td22 = max(d21, d22);\n\td21 = min(d2a, d23); // Smallest now not in d22 or d23\n\td23 = max(d2a, d23);\n\td22 = min(d22, d23); // 2nd smallest now not in d23\n\tvec3 d3a = min(d31, d32);\n\td32 = max(d31, d32);\n\td31 = min(d3a, d33); // Smallest now not in d32 or d33\n\td33 = max(d3a, d33);\n\td32 = min(d32, d33); // 2nd smallest now not in d33\n\tvec3 da = min(d11, d21);\n\td21 = max(d11, d21);\n\td11 = min(da, d31); // Smallest now in d11\n\td31 = max(da, d31); // 2nd smallest now not in d31\n\td11.xy = (d11.x < d11.y) ? d11.xy : d11.yx;\n\td11.xz = (d11.x < d11.z) ? d11.xz : d11.zx; // d11.x now smallest\n\td12 = min(d12, d21); // 2nd smallest now not in d21\n\td12 = min(d12, d22); // nor in d22\n\td12 = min(d12, d31); // nor in d31\n\td12 = min(d12, d32); // nor in d32\n\td11.yz = min(d11.yz,d12.xy); // nor in d12.yz\n\td11.y = min(d11.y,d12.z); // Only two more to go\n\td11.y = min(d11.y,d11.z); // Done! (Phew!)\n\n  vec2 F = sqrt(d11.xy);\n\treturn F.x; // F1, F2\n\n}\n\nfloat lamina_noise_swirl(vec3 position) {\n    float scale = 0.1;\n    float freq = 4. * scale;\n    float t = 1.;\n\n    vec3 pos = (position * scale) + lamina_noise_curl(position * 7. * scale);\n\n    float worley1 = 1. - lamina_noise_worley((pos * (freq * 2.)) +  (t * 2.));\n    float worley2 = 1. - lamina_noise_worley((pos * (freq * 4.)) +  (t * 4.));\n    float worley3 = 1. - lamina_noise_worley((pos * (freq * 8.)) +  (t * 8.));\n    float worley4 = 1. - lamina_noise_worley((pos * (freq * 16.)) +  (t * 16.));\n    \n    float fbm1 = worley1 * .625 + worley2 * .25 + worley3 * .125;\n    float fbm2 = worley2 * .625 + worley3 * .25 + worley4 * .125;\n    float fbm3 = worley3 * .75 + worley4 * .25;\n\n    vec3 curlWorleyFbm = vec3(fbm1, fbm2, fbm3);\n    float curlWorley = curlWorleyFbm.r * .625 + curlWorleyFbm.g * .25 + \n        curlWorleyFbm.b * .125;\n\n    return curlWorley;\n}\n  \n  \n",H="\n\nfloat lamina_map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nfloat lamina_normalize(float v) { return lamina_map(v, -1.0, 1.0, 0.0, 1.0); }\n",$=function(n){(0,i.Z)(t,n);var e=(0,c.Z)(t);function t(){var n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.color,a=r.alpha,i=r.lighting,c=r.layers,l=r.name,f=(0,d.Z)(r,j);(0,u.Z)(this,t),(n=e.call(this,(0,s.Z)({baseMaterial:L[i||"basic"]},f))).name="LayerMaterial",n.layers=[],n.lighting="basic";var p=o||"white",m=null!=a?a:1;return n.uniforms={u_lamina_color:{value:"string"===typeof p?new g.Color(p).convertSRGBToLinear():p},u_lamina_alpha:{value:m}},n.layers=c||n.layers,n.lighting=i||n.lighting,n.name=l||n.name,n.refresh(),n}return(0,f.Z)(t,[{key:"genShaders",value:function(){var n="",e="",t="",r="",o={};return this.layers.filter((function(n){return n.visible})).forEach((function(a){n+=a.vertexVariables+"\n",e+=a.fragmentVariables+"\n",t+=a.vertexShader+"\n",r+=a.fragmentShader+"\n",o=(0,s.Z)((0,s.Z)({},o),a.uniforms)})),{uniforms:o=(0,s.Z)((0,s.Z)({},o),this.uniforms),vertexShader:"\n        ".concat(H,"\n        ").concat(X,"\n        ").concat(n,"\n\n        void main() {\n          vec3 lamina_finalPosition = position;\n          vec3 lamina_finalNormal = normal;\n\n          ").concat(t,"\n\n          csm_Position = lamina_finalPosition;\n          csm_Normal = lamina_finalNormal;\n        }\n        "),fragmentShader:"\n        ".concat(H,"\n        ").concat(X,"\n        ").concat("\nvec4 lamina_blend_add(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(min(x.xyz + y.xyz, 1.0) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec3 lamina_blend_alpha(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn y * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 lamina_blend_alpha(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\tfloat a = min(y.a, opacity);\n\n\treturn vec4(lamina_blend_alpha(x.rgb, y.rgb, a), x.a);\n\n}\nvec4 lamina_blend_average(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4((x.xyz + y.xyz) * 0.5 * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nfloat lamina_blend_color_burn(const in float x, const in float y) {\n\n\treturn (y == 0.0) ? y : max(1.0 - (1.0 - x) / y, 0.0);\n\n}\n\nvec4 lamina_blend_color_burn(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\tvec4 z = vec4(\n\t\tlamina_blend_color_burn(x.r, y.r),\n\t\tlamina_blend_color_burn(x.g, y.g),\n\t\tlamina_blend_color_burn(x.b, y.b),\n\t\tlamina_blend_color_burn(x.a, y.a)\n\t);\n\n\treturn vec4(z.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nfloat lamina_blend_color_dodge(const in float x, const in float y) {\n\n\treturn (y == 1.0) ? y : min(x / (1.0 - y), 1.0);\n\n}\n\nvec4 lamina_blend_color_dodge(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\tvec4 z = vec4(\n\t\tlamina_blend_color_dodge(x.r, y.r),\n\t\tlamina_blend_color_dodge(x.g, y.g),\n\t\tlamina_blend_color_dodge(x.b, y.b),\n\t\tlamina_blend_color_dodge(x.a, y.a)\n\t);\n\n\treturn vec4(z.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_darken(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(min(x.xyz, y.xyz) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_difference(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(abs(x.xyz - y.xyz) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nfloat lamina_blend_divide(const in float x, const in float y) {\n\n\treturn (y > 0.0) ? min(x / y, 1.0) : 1.0;\n\n}\n\nvec4 lamina_blend_divide(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\tvec4 z = vec4(\n\t\tlamina_blend_divide(x.r, y.r),\n\t\tlamina_blend_divide(x.g, y.g),\n\t\tlamina_blend_divide(x.b, y.b),\n\t\tlamina_blend_divide(x.a, y.a)\n\t);\n\n\treturn vec4(z.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_exclusion(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4((x.xyz + y.xyz - 2.0 * x.xyz * y.xyz) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_lighten(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(max(x.xyz, y.xyz) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_multiply(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4( x.xyz * y.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_negation(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4((1.0 - abs(1.0 - x.xyz - y.xyz)) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_normal(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(y.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nfloat lamina_blend_overlay(const in float x, const in float y) {\n\n\treturn (x < 0.5) ? (2.0 * x * y) : (1.0 - 2.0 * (1.0 - x) * (1.0 - y));\n\n}\n\nvec4 lamina_blend_overlay(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\tvec4 z = vec4(\n\t\tlamina_blend_overlay(x.r, y.r),\n\t\tlamina_blend_overlay(x.g, y.g),\n\t\tlamina_blend_overlay(x.b, y.b),\n\t\tlamina_blend_overlay(x.a, y.a)\n\t);\n\n\treturn vec4(z.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nfloat lamina_blend_reflect(const in float x, const in float y) {\n\n\treturn (y == 1.0) ? y : min(x * x / (1.0 - y), 1.0);\n\n}\n\nvec4 lamina_blend_reflect(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\tvec4 z = vec4(\n\t\tlamina_blend_reflect(x.r, y.r),\n\t\tlamina_blend_reflect(x.g, y.g),\n\t\tlamina_blend_reflect(x.b, y.b),\n\t\tlamina_blend_reflect(x.a, y.a)\n\t);\n\n\treturn vec4(z.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_screen(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4((1.0 - (1.0 - x.xyz) * (1.0 - y.xyz)) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nfloat lamina_blend_softlight(const in float x, const in float y) {\n\n\treturn (y < 0.5) ?\n\t\t(2.0 * x * y + x * x * (1.0 - 2.0 * y)) :\n\t\t(sqrt(x) * (2.0 * y - 1.0) + 2.0 * x * (1.0 - y));\n\n}\n\nvec4 lamina_blend_softlight(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\tvec4 z = vec4(\n\t\tlamina_blend_softlight(x.r, y.r),\n\t\tlamina_blend_softlight(x.g, y.g),\n\t\tlamina_blend_softlight(x.b, y.b),\n\t\tlamina_blend_softlight(x.a, y.a)\n\t);\n\n\treturn vec4(z.xyz * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\nvec4 lamina_blend_subtract(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(max(x.xyz + y.xyz - 1.0, 0.0) * opacity + x.xyz * (1.0 - opacity), x.a);\n\n}\n\n","\n        ").concat(e,"\n\n        uniform vec3 u_lamina_color;\n        uniform float u_lamina_alpha;\n\n        void main() {\n          vec4 lamina_finalColor = vec4(u_lamina_color, u_lamina_alpha);\n\n          ").concat(r,"\n\n          csm_DiffuseColor = lamina_finalColor;\n         \n        }\n        ")}}},{key:"refresh",value:function(){var n=this.genShaders(),e=n.uniforms,r=n.fragmentShader,i=n.vertexShader;(0,o.Z)((0,a.Z)(t.prototype),"update",this).call(this,{fragmentShader:r,vertexShader:i,uniforms:e})}},{key:"serialize",value:function(){return{constructor:"LayerMaterial",properties:{color:this.color,alpha:this.alpha,name:this.name,lighting:this.lighting}}}},{key:"color",get:function(){var n,e;return null==(n=this.uniforms)||null==(e=n.u_lamina_color)?void 0:e.value},set:function(n){var e,t;null!=(e=this.uniforms)&&null!=(t=e.u_lamina_color)&&t.value&&(this.uniforms.u_lamina_color.value="string"===typeof n?new g.Color(n).convertSRGBToLinear():n)}},{key:"alpha",get:function(){return this.uniforms.u_lamina_alpha.value},set:function(n){this.uniforms.u_lamina_alpha.value=n}}]),t}(M.Z);(0,m.e)({LayerMaterial:$});(0,m.e)({LayerMaterial:$,Depth_:U,Color_:N,Noise_:V,Fresnel_:O,Gradient_:R,Matcap_:Y,Texture_:q,Displace_:W,Normal_:G});var J=v.forwardRef((function(n,e){var t=n.children,o=(0,d.Z)(n,C),a=v.useRef(null);v.useLayoutEffect((function(){a.current.layers=a.current.__r3f.objects,a.current.refresh()}),[t]);var i=(0,v.useMemo)((function(){return k(o)}),[o]),c=(0,r.Z)(i,2),l=c[0],s=c[1];return v.createElement("layerMaterial",(0,p.Z)({args:[l],ref:(0,h.Z)([a,e])},s),t)}));function Q(n){return[{mode:null==n?void 0:n.mode,visible:null==n?void 0:n.visible,type:null==n?void 0:n.type,mapping:null==n?void 0:n.mapping,map:null==n?void 0:n.map,axes:null==n?void 0:n.axes}]}var nn=v.forwardRef((function(n,e){return v.createElement("depth_",(0,p.Z)({args:Q(n),ref:e},n))})),en=v.forwardRef((function(n,e){return v.createElement("noise_",(0,p.Z)({ref:e,args:Q(n)},n))})),tn=v.forwardRef((function(n,e){return v.createElement("fresnel_",(0,p.Z)({ref:e,args:Q(n)},n))})),rn=v.forwardRef((function(n,e){return v.createElement("texture_",(0,p.Z)({ref:e,args:Q(n)},n))}))},4101:function(n){n.exports=function n(e,t,r){function o(i,c){if(!t[i]){if(!e[i]){if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}c=t[i]={exports:{}},e[i][0].call(c.exports,(function(n){return o(e[i][1][n]||n)}),c,c.exports,n,e,t,r)}return t[i].exports}for(var a=void 0,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(n,e,t){(function(r,o,a,i,c,l,s,u,f){"use strict";var d=n("crypto");function p(n,e){var t;return void 0===(t="passthrough"!==(e=h(n,e)).algorithm?d.createHash(e.algorithm):new _).write&&(t.write=t.update,t.end=t.update),y(e,t).dispatch(n),t.update||t.end(""),t.digest?t.digest("buffer"===e.encoding?void 0:e.encoding):(n=t.read(),"buffer"!==e.encoding?n.toString(e.encoding):n)}(t=e.exports=p).sha1=function(n){return p(n)},t.keys=function(n){return p(n,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},t.MD5=function(n){return p(n,{algorithm:"md5",encoding:"hex"})},t.keysMD5=function(n){return p(n,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=d.getHashes?d.getHashes().slice():["sha1","md5"],v=(m.push("passthrough"),["buffer","hex","binary","base64"]);function h(n,e){var t={};if(t.algorithm=(e=e||{}).algorithm||"sha1",t.encoding=e.encoding||"hex",t.excludeValues=!!e.excludeValues,t.algorithm=t.algorithm.toLowerCase(),t.encoding=t.encoding.toLowerCase(),t.ignoreUnknown=!0===e.ignoreUnknown,t.respectType=!1!==e.respectType,t.respectFunctionNames=!1!==e.respectFunctionNames,t.respectFunctionProperties=!1!==e.respectFunctionProperties,t.unorderedArrays=!0===e.unorderedArrays,t.unorderedSets=!1!==e.unorderedSets,t.unorderedObjects=!1!==e.unorderedObjects,t.replacer=e.replacer||void 0,t.excludeKeys=e.excludeKeys||void 0,void 0===n)throw new Error("Object argument required.");for(var r=0;r<m.length;++r)m[r].toLowerCase()===t.algorithm.toLowerCase()&&(t.algorithm=m[r]);if(-1===m.indexOf(t.algorithm))throw new Error('Algorithm "'+t.algorithm+'"  not supported. supported values: '+m.join(", "));if(-1===v.indexOf(t.encoding)&&"passthrough"!==t.algorithm)throw new Error('Encoding "'+t.encoding+'"  not supported. supported values: '+v.join(", "));return t}function g(n){if("function"==typeof n)return null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(n))}function y(n,e,t){function r(n){return e.update?e.update(n,"utf8"):e.write(n,"utf8")}return t=t||[],{dispatch:function(e){return this["_"+(null===(e=n.replacer?n.replacer(e):e)?"null":typeof e)](e)},_object:function(e){var o,i=Object.prototype.toString.call(e),c=/\[object (.*)\]/i.exec(i);if(c=(c=c?c[1]:"unknown:["+i+"]").toLowerCase(),0<=(i=t.indexOf(e)))return this.dispatch("[CIRCULAR:"+i+"]");if(t.push(e),void 0!==a&&a.isBuffer&&a.isBuffer(e))return r("buffer:"),r(e);if("object"===c||"function"===c||"asyncfunction"===c)return i=Object.keys(e),n.unorderedObjects&&(i=i.sort()),!1===n.respectType||g(e)||i.splice(0,0,"prototype","__proto__","constructor"),n.excludeKeys&&(i=i.filter((function(e){return!n.excludeKeys(e)}))),r("object:"+i.length+":"),o=this,i.forEach((function(t){o.dispatch(t),r(":"),n.excludeValues||o.dispatch(e[t]),r(",")}));if(!this["_"+c]){if(n.ignoreUnknown)return r("["+c+"]");throw new Error('Unknown object type "'+c+'"')}this["_"+c](e)},_array:function(e,o){o=void 0!==o?o:!1!==n.unorderedArrays;var a=this;if(r("array:"+e.length+":"),!o||e.length<=1)return e.forEach((function(n){return a.dispatch(n)}));var i=[];return o=e.map((function(e){var r=new _,o=t.slice();return y(n,r,o).dispatch(e),i=i.concat(o.slice(t.length)),r.read().toString()})),t=t.concat(i),o.sort(),this._array(o,!1)},_date:function(n){return r("date:"+n.toJSON())},_symbol:function(n){return r("symbol:"+n.toString())},_error:function(n){return r("error:"+n.toString())},_boolean:function(n){return r("bool:"+n.toString())},_string:function(n){r("string:"+n.length+":"),r(n.toString())},_function:function(e){r("fn:"),g(e)?this.dispatch("[native]"):this.dispatch(e.toString()),!1!==n.respectFunctionNames&&this.dispatch("function-name:"+String(e.name)),n.respectFunctionProperties&&this._object(e)},_number:function(n){return r("number:"+n.toString())},_xml:function(n){return r("xml:"+n.toString())},_null:function(){return r("Null")},_undefined:function(){return r("Undefined")},_regexp:function(n){return r("regex:"+n.toString())},_uint8array:function(n){return r("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){return r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){return r("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){return r("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){return r("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){return r("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){return r("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){return r("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){return r("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){return r("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){return r("url:"+n.toString())},_map:function(e){return r("map:"),e=Array.from(e),this._array(e,!1!==n.unorderedSets)},_set:function(e){return r("set:"),e=Array.from(e),this._array(e,!1!==n.unorderedSets)},_file:function(n){return r("file:"),this.dispatch([n.name,n.size,n.type,n.lastModfied])},_blob:function(){if(n.ignoreUnknown)return r("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return r("domwindow")},_bigint:function(n){return r("bigint:"+n.toString())},_process:function(){return r("process")},_timer:function(){return r("timer")},_pipe:function(){return r("pipe")},_tcp:function(){return r("tcp")},_udp:function(){return r("udp")},_tty:function(){return r("tty")},_statwatcher:function(){return r("statwatcher")},_securecontext:function(){return r("securecontext")},_connection:function(){return r("connection")},_zlib:function(){return r("zlib")},_context:function(){return r("context")},_nodescript:function(){return r("nodescript")},_httpparser:function(){return r("httpparser")},_dataview:function(){return r("dataview")},_signal:function(){return r("signal")},_fsevent:function(){return r("fsevent")},_tlswrap:function(){return r("tlswrap")}}}function _(){return{buf:"",write:function(n){this.buf+=n},end:function(n){this.buf+=n},read:function(){return this.buf}}}t.writeToStream=function(n,e,t){return void 0===t&&(t=e,e={}),y(e=h(n,e),t).dispatch(n)}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(n,e,t){(function(n,e,r,o,a,i,c,l,s){!function(n){"use strict";var e="undefined"!=typeof Uint8Array?Uint8Array:Array,t="+".charCodeAt(0),r="/".charCodeAt(0),o="0".charCodeAt(0),a="a".charCodeAt(0),i="A".charCodeAt(0),c="-".charCodeAt(0),l="_".charCodeAt(0);function s(n){return(n=n.charCodeAt(0))===t||n===c?62:n===r||n===l?63:n<o?-1:n<o+10?n-o+26+26:n<i+26?n-i:n<a+26?n-a+26:void 0}n.toByteArray=function(n){var t,r;if(0<n.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var o=n.length,a=(o="="===n.charAt(o-2)?2:"="===n.charAt(o-1)?1:0,new e(3*n.length/4-o)),i=0<o?n.length-4:n.length,c=0;function l(n){a[c++]=n}for(t=0;t<i;t+=4,0)l((16711680&(r=s(n.charAt(t))<<18|s(n.charAt(t+1))<<12|s(n.charAt(t+2))<<6|s(n.charAt(t+3))))>>16),l((65280&r)>>8),l(255&r);return 2==o?l(255&(r=s(n.charAt(t))<<2|s(n.charAt(t+1))>>4)):1==o&&(l((r=s(n.charAt(t))<<10|s(n.charAt(t+1))<<4|s(n.charAt(t+2))>>2)>>8&255),l(255&r)),a},n.fromByteArray=function(n){var e,t,r,o,a=n.length%3,i="";function c(n){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n)}for(e=0,r=n.length-a;e<r;e+=3)i+=c((o=t=(n[e]<<16)+(n[e+1]<<8)+n[e+2])>>18&63)+c(o>>12&63)+c(o>>6&63)+c(63&o);switch(a){case 1:i=(i+=c((t=n[n.length-1])>>2))+c(t<<4&63)+"==";break;case 2:i=(i=(i+=c((t=(n[n.length-2]<<8)+n[n.length-1])>>10))+c(t>>4&63))+c(t<<2&63)+"="}return i}}(void 0===t?this.base64js={}:t)}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(n,e,t){(function(e,r,o,a,i,c,l,s,u){var f=n("base64-js"),d=n("ieee754");function o(n,e,t){if(!(this instanceof o))return new o(n,e,t);var r,a,i,c,l=typeof n;if("base64"===e&&"string"==l)for(n=(c=n).trim?c.trim():c.replace(/^\s+|\s+$/g,"");n.length%4!=0;)n+="=";if("number"==l)r=C(n);else if("string"==l)r=o.byteLength(n,e);else{if("object"!=l)throw new Error("First argument needs to be a number, array or string.");r=C(n.length)}if(o._useTypedArrays?a=o._augment(new Uint8Array(r)):((a=this).length=r,a._isBuffer=!0),o._useTypedArrays&&"number"==typeof n.byteLength)a._set(n);else if(D(c=n)||o.isBuffer(c)||c&&"object"==typeof c&&"number"==typeof c.length)for(i=0;i<r;i++)o.isBuffer(n)?a[i]=n.readUInt8(i):a[i]=n[i];else if("string"==l)a.write(n,0,e);else if("number"==l&&!o._useTypedArrays&&!t)for(i=0;i<r;i++)a[i]=0;return a}function p(n,e,t,r){return o._charsWritten=T(function(n){for(var e=[],t=0;t<n.length;t++)e.push(255&n.charCodeAt(t));return e}(e),n,t,r)}function m(n,e,t,r){return o._charsWritten=T(function(n){for(var e,t,r=[],o=0;o<n.length;o++)e=(t=n.charCodeAt(o))>>8,t%=256,r.push(t),r.push(e);return r}(e),n,t,r)}function v(n,e,t){var r="";t=Math.min(n.length,t);for(var o=e;o<t;o++)r+=String.fromCharCode(n[o]);return r}function h(n,e,t,r){var o;if(r||(U("boolean"==typeof t,"missing or invalid endian"),U(null!=e,"missing offset"),U(e+1<n.length,"Trying to read beyond buffer length")),!((r=n.length)<=e))return t?(o=n[e],e+1<r&&(o|=n[e+1]<<8)):(o=n[e]<<8,e+1<r&&(o|=n[e+1])),o}function g(n,e,t,r){var o;if(r||(U("boolean"==typeof t,"missing or invalid endian"),U(null!=e,"missing offset"),U(e+3<n.length,"Trying to read beyond buffer length")),!((r=n.length)<=e))return t?(e+2<r&&(o=n[e+2]<<16),e+1<r&&(o|=n[e+1]<<8),o|=n[e],e+3<r&&(o+=n[e+3]<<24>>>0)):(e+1<r&&(o=n[e+1]<<16),e+2<r&&(o|=n[e+2]<<8),e+3<r&&(o|=n[e+3]),o+=n[e]<<24>>>0),o}function y(n,e,t,r){if(r||(U("boolean"==typeof t,"missing or invalid endian"),U(null!=e,"missing offset"),U(e+1<n.length,"Trying to read beyond buffer length")),!(n.length<=e))return 32768&(r=h(n,e,t,!0))?-1*(65535-r+1):r}function _(n,e,t,r){if(r||(U("boolean"==typeof t,"missing or invalid endian"),U(null!=e,"missing offset"),U(e+3<n.length,"Trying to read beyond buffer length")),!(n.length<=e))return 2147483648&(r=g(n,e,t,!0))?-1*(4294967295-r+1):r}function x(n,e,t,r){return r||(U("boolean"==typeof t,"missing or invalid endian"),U(e+3<n.length,"Trying to read beyond buffer length")),d.read(n,e,t,23,4)}function b(n,e,t,r){return r||(U("boolean"==typeof t,"missing or invalid endian"),U(e+7<n.length,"Trying to read beyond buffer length")),d.read(n,e,t,52,8)}function w(n,e,t,r,o){if(o||(U(null!=e,"missing value"),U("boolean"==typeof r,"missing or invalid endian"),U(null!=t,"missing offset"),U(t+1<n.length,"trying to write beyond buffer length"),F(e,65535)),!((o=n.length)<=t))for(var a=0,i=Math.min(o-t,2);a<i;a++)n[t+a]=(e&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function z(n,e,t,r,o){if(o||(U(null!=e,"missing value"),U("boolean"==typeof r,"missing or invalid endian"),U(null!=t,"missing offset"),U(t+3<n.length,"trying to write beyond buffer length"),F(e,4294967295)),!((o=n.length)<=t))for(var a=0,i=Math.min(o-t,4);a<i;a++)n[t+a]=e>>>8*(r?a:3-a)&255}function P(n,e,t,r,o){o||(U(null!=e,"missing value"),U("boolean"==typeof r,"missing or invalid endian"),U(null!=t,"missing offset"),U(t+1<n.length,"Trying to write beyond buffer length"),L(e,32767,-32768)),n.length<=t||w(n,0<=e?e:65535+e+1,t,r,o)}function S(n,e,t,r,o){o||(U(null!=e,"missing value"),U("boolean"==typeof r,"missing or invalid endian"),U(null!=t,"missing offset"),U(t+3<n.length,"Trying to write beyond buffer length"),L(e,2147483647,-2147483648)),n.length<=t||z(n,0<=e?e:4294967295+e+1,t,r,o)}function M(n,e,t,r,o){o||(U(null!=e,"missing value"),U("boolean"==typeof r,"missing or invalid endian"),U(null!=t,"missing offset"),U(t+3<n.length,"Trying to write beyond buffer length"),K(e,34028234663852886e22,-34028234663852886e22)),n.length<=t||d.write(n,e,t,r,23,4)}function E(n,e,t,r,o){o||(U(null!=e,"missing value"),U("boolean"==typeof r,"missing or invalid endian"),U(null!=t,"missing offset"),U(t+7<n.length,"Trying to write beyond buffer length"),K(e,17976931348623157e292,-17976931348623157e292)),n.length<=t||d.write(n,e,t,r,52,8)}t.Buffer=o,t.SlowBuffer=o,t.INSPECT_MAX_BYTES=50,o.poolSize=8192,o._useTypedArrays=function(){try{var n=new ArrayBuffer(0),e=new Uint8Array(n);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray}catch(n){return!1}}(),o.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.isBuffer=function(n){return!(null==n||!n._isBuffer)},o.byteLength=function(n,e){var t;switch(n+="",e||"utf8"){case"hex":t=n.length/2;break;case"utf8":case"utf-8":t=A(n).length;break;case"ascii":case"binary":case"raw":t=n.length;break;case"base64":t=B(n).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":t=2*n.length;break;default:throw new Error("Unknown encoding")}return t},o.concat=function(n,e){if(U(D(n),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===n.length)return new o(0);if(1===n.length)return n[0];if("number"!=typeof e)for(a=e=0;a<n.length;a++)e+=n[a].length;for(var t=new o(e),r=0,a=0;a<n.length;a++){var i=n[a];i.copy(t,r),r+=i.length}return t},o.prototype.write=function(n,e,t,r){isFinite(e)?isFinite(t)||(r=t,t=void 0):(s=r,r=e,e=t,t=s),e=Number(e)||0;var a,i,c,l,s=this.length-e;switch((!t||s<(t=Number(t)))&&(t=s),r=String(r||"utf8").toLowerCase()){case"hex":a=function(n,e,t,r){t=Number(t)||0;var a=n.length-t;(!r||a<(r=Number(r)))&&(r=a),U((a=e.length)%2==0,"Invalid hex string"),a/2<r&&(r=a/2);for(var i=0;i<r;i++){var c=parseInt(e.substr(2*i,2),16);U(!isNaN(c),"Invalid hex string"),n[t+i]=c}return o._charsWritten=2*i,i}(this,n,e,t);break;case"utf8":case"utf-8":i=this,c=e,l=t,a=o._charsWritten=T(A(n),i,c,l);break;case"ascii":case"binary":a=p(this,n,e,t);break;case"base64":i=this,c=e,l=t,a=o._charsWritten=T(B(n),i,c,l);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=m(this,n,e,t);break;default:throw new Error("Unknown encoding")}return a},o.prototype.toString=function(n,e,t){var r,o,a,i,c=this;if(n=String(n||"utf8").toLowerCase(),e=Number(e)||0,(t=void 0!==t?Number(t):c.length)===e)return"";switch(n){case"hex":r=function(n,e,t){var r=n.length;(!e||e<0)&&(e=0),(!t||t<0||r<t)&&(t=r);for(var o="",a=e;a<t;a++)o+=k(n[a]);return o}(c,e,t);break;case"utf8":case"utf-8":r=function(n,e,t){var r="",o="";t=Math.min(n.length,t);for(var a=e;a<t;a++)n[a]<=127?(r+=Z(o)+String.fromCharCode(n[a]),o=""):o+="%"+n[a].toString(16);return r+Z(o)}(c,e,t);break;case"ascii":case"binary":r=v(c,e,t);break;case"base64":o=c,i=t,r=0===(a=e)&&i===o.length?f.fromByteArray(o):f.fromByteArray(o.slice(a,i));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=function(n,e,t){for(var r=n.slice(e,t),o="",a=0;a<r.length;a+=2)o+=String.fromCharCode(r[a]+256*r[a+1]);return o}(c,e,t);break;default:throw new Error("Unknown encoding")}return r},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.copy=function(n,e,t,r){if(e=e||0,(r=r||0===r?r:this.length)!==(t=t||0)&&0!==n.length&&0!==this.length){U(t<=r,"sourceEnd < sourceStart"),U(0<=e&&e<n.length,"targetStart out of bounds"),U(0<=t&&t<this.length,"sourceStart out of bounds"),U(0<=r&&r<=this.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length);var a=(r=n.length-e<r-t?n.length-e+t:r)-t;if(a<100||!o._useTypedArrays)for(var i=0;i<a;i++)n[i+e]=this[i+t];else n._set(this.subarray(t,t+a),e)}},o.prototype.slice=function(n,e){var t=this.length;if(n=j(n,t,0),e=j(e,t,t),o._useTypedArrays)return o._augment(this.subarray(n,e));for(var r=e-n,a=new o(r,void 0,!0),i=0;i<r;i++)a[i]=this[i+n];return a},o.prototype.get=function(n){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(n)},o.prototype.set=function(n,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(n,e)},o.prototype.readUInt8=function(n,e){if(e||(U(null!=n,"missing offset"),U(n<this.length,"Trying to read beyond buffer length")),!(n>=this.length))return this[n]},o.prototype.readUInt16LE=function(n,e){return h(this,n,!0,e)},o.prototype.readUInt16BE=function(n,e){return h(this,n,!1,e)},o.prototype.readUInt32LE=function(n,e){return g(this,n,!0,e)},o.prototype.readUInt32BE=function(n,e){return g(this,n,!1,e)},o.prototype.readInt8=function(n,e){if(e||(U(null!=n,"missing offset"),U(n<this.length,"Trying to read beyond buffer length")),!(n>=this.length))return 128&this[n]?-1*(255-this[n]+1):this[n]},o.prototype.readInt16LE=function(n,e){return y(this,n,!0,e)},o.prototype.readInt16BE=function(n,e){return y(this,n,!1,e)},o.prototype.readInt32LE=function(n,e){return _(this,n,!0,e)},o.prototype.readInt32BE=function(n,e){return _(this,n,!1,e)},o.prototype.readFloatLE=function(n,e){return x(this,n,!0,e)},o.prototype.readFloatBE=function(n,e){return x(this,n,!1,e)},o.prototype.readDoubleLE=function(n,e){return b(this,n,!0,e)},o.prototype.readDoubleBE=function(n,e){return b(this,n,!1,e)},o.prototype.writeUInt8=function(n,e,t){t||(U(null!=n,"missing value"),U(null!=e,"missing offset"),U(e<this.length,"trying to write beyond buffer length"),F(n,255)),e>=this.length||(this[e]=n)},o.prototype.writeUInt16LE=function(n,e,t){w(this,n,e,!0,t)},o.prototype.writeUInt16BE=function(n,e,t){w(this,n,e,!1,t)},o.prototype.writeUInt32LE=function(n,e,t){z(this,n,e,!0,t)},o.prototype.writeUInt32BE=function(n,e,t){z(this,n,e,!1,t)},o.prototype.writeInt8=function(n,e,t){t||(U(null!=n,"missing value"),U(null!=e,"missing offset"),U(e<this.length,"Trying to write beyond buffer length"),L(n,127,-128)),e>=this.length||(0<=n?this.writeUInt8(n,e,t):this.writeUInt8(255+n+1,e,t))},o.prototype.writeInt16LE=function(n,e,t){P(this,n,e,!0,t)},o.prototype.writeInt16BE=function(n,e,t){P(this,n,e,!1,t)},o.prototype.writeInt32LE=function(n,e,t){S(this,n,e,!0,t)},o.prototype.writeInt32BE=function(n,e,t){S(this,n,e,!1,t)},o.prototype.writeFloatLE=function(n,e,t){M(this,n,e,!0,t)},o.prototype.writeFloatBE=function(n,e,t){M(this,n,e,!1,t)},o.prototype.writeDoubleLE=function(n,e,t){E(this,n,e,!0,t)},o.prototype.writeDoubleBE=function(n,e,t){E(this,n,e,!1,t)},o.prototype.fill=function(n,e,t){if(e=e||0,t=t||this.length,U("number"==typeof(n="string"==typeof(n=n||0)?n.charCodeAt(0):n)&&!isNaN(n),"value is not a number"),U(e<=t,"end < start"),t!==e&&0!==this.length){U(0<=e&&e<this.length,"start out of bounds"),U(0<=t&&t<=this.length,"end out of bounds");for(var r=e;r<t;r++)this[r]=n}},o.prototype.inspect=function(){for(var n=[],e=this.length,r=0;r<e;r++)if(n[r]=k(this[r]),r===t.INSPECT_MAX_BYTES){n[r+1]="...";break}return"<Buffer "+n.join(" ")+">"},o.prototype.toArrayBuffer=function(){if("undefined"==typeof Uint8Array)throw new Error("Buffer.toArrayBuffer not supported in this browser");if(o._useTypedArrays)return new o(this).buffer;for(var n=new Uint8Array(this.length),e=0,t=n.length;e<t;e+=1)n[e]=this[e];return n.buffer};var I=o.prototype;function j(n,e,t){return"number"!=typeof n?t:e<=(n=~~n)?e:0<=n||0<=(n+=e)?n:0}function C(n){return(n=~~Math.ceil(+n))<0?0:n}function D(n){return(Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)})(n)}function k(n){return n<16?"0"+n.toString(16):n.toString(16)}function A(n){for(var e=[],t=0;t<n.length;t++){var r=n.charCodeAt(t);if(r<=127)e.push(n.charCodeAt(t));else for(var o=t,a=(55296<=r&&r<=57343&&t++,encodeURIComponent(n.slice(o,t+1)).substr(1).split("%")),i=0;i<a.length;i++)e.push(parseInt(a[i],16))}return e}function B(n){return f.toByteArray(n)}function T(n,e,t,r){for(var o=0;o<r&&!(o+t>=e.length||o>=n.length);o++)e[o+t]=n[o];return o}function Z(n){try{return decodeURIComponent(n)}catch(n){return String.fromCharCode(65533)}}function F(n,e){U("number"==typeof n,"cannot write a non-number as a number"),U(0<=n,"specified a negative value for writing an unsigned value"),U(n<=e,"value is larger than maximum value for type"),U(Math.floor(n)===n,"value has a fractional component")}function L(n,e,t){U("number"==typeof n,"cannot write a non-number as a number"),U(n<=e,"value larger than maximum allowed value"),U(t<=n,"value smaller than minimum allowed value"),U(Math.floor(n)===n,"value has a fractional component")}function K(n,e,t){U("number"==typeof n,"cannot write a non-number as a number"),U(n<=e,"value larger than maximum allowed value"),U(t<=n,"value smaller than minimum allowed value")}function U(n,e){if(!n)throw new Error(e||"Failed assertion")}o._augment=function(n){return n._isBuffer=!0,n._get=n.get,n._set=n.set,n.get=I.get,n.set=I.set,n.write=I.write,n.toString=I.toString,n.toLocaleString=I.toString,n.toJSON=I.toJSON,n.copy=I.copy,n.slice=I.slice,n.readUInt8=I.readUInt8,n.readUInt16LE=I.readUInt16LE,n.readUInt16BE=I.readUInt16BE,n.readUInt32LE=I.readUInt32LE,n.readUInt32BE=I.readUInt32BE,n.readInt8=I.readInt8,n.readInt16LE=I.readInt16LE,n.readInt16BE=I.readInt16BE,n.readInt32LE=I.readInt32LE,n.readInt32BE=I.readInt32BE,n.readFloatLE=I.readFloatLE,n.readFloatBE=I.readFloatBE,n.readDoubleLE=I.readDoubleLE,n.readDoubleBE=I.readDoubleBE,n.writeUInt8=I.writeUInt8,n.writeUInt16LE=I.writeUInt16LE,n.writeUInt16BE=I.writeUInt16BE,n.writeUInt32LE=I.writeUInt32LE,n.writeUInt32BE=I.writeUInt32BE,n.writeInt8=I.writeInt8,n.writeInt16LE=I.writeInt16LE,n.writeInt16BE=I.writeInt16BE,n.writeInt32LE=I.writeInt32LE,n.writeInt32BE=I.writeInt32BE,n.writeFloatLE=I.writeFloatLE,n.writeFloatBE=I.writeFloatBE,n.writeDoubleLE=I.writeDoubleLE,n.writeDoubleBE=I.writeDoubleBE,n.fill=I.fill,n.inspect=I.inspect,n.toArrayBuffer=I.toArrayBuffer,n}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(n,e,t){(function(t,r,o,a,i,c,l,s,u){o=n("buffer").Buffer;var f=4,d=new o(f);d.fill(0),e.exports={hash:function(n,e,t,r){for(var a=e(function(n,e){n.length%f!=0&&(t=n.length+(f-n.length%f),n=o.concat([n,d],t));for(var t,r=[],a=e?n.readInt32BE:n.readInt32LE,i=0;i<n.length;i+=f)r.push(a.call(n,i));return r}(n=o.isBuffer(n)?n:new o(n),r),8*n.length),i=(e=r,new o(t)),c=e?i.writeInt32BE:i.writeInt32LE,l=0;l<a.length;l++)c.call(i,a[l],4*l,!0);return i}}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(n,e,t){(function(e,r,o,a,i,c,l,s,u){o=n("buffer").Buffer;var f=n("./sha"),d=n("./sha256"),p=n("./rng"),m={sha1:f,sha256:d,md5:n("./md5")},v=64,h=new o(v);function g(n,e){var t=m[n=n||"sha1"],r=[];return t||y("algorithm:",n,"is not yet supported"),{update:function(n){return o.isBuffer(n)||(n=new o(n)),r.push(n),n.length,this},digest:function(n){var a=o.concat(r);return a=e?function(n,e,t){o.isBuffer(e)||(e=new o(e)),o.isBuffer(t)||(t=new o(t)),e.length>v?e=n(e):e.length<v&&(e=o.concat([e,h],v));for(var r=new o(v),a=new o(v),i=0;i<v;i++)r[i]=54^e[i],a[i]=92^e[i];return t=n(o.concat([r,t])),n(o.concat([a,t]))}(t,e,a):t(a),r=null,n?a.toString(n):a}}}function y(){var n=[].slice.call(arguments).join(" ");throw new Error([n,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}h.fill(0),t.createHash=function(n){return g(n)},t.createHmac=g,t.randomBytes=function(n,e){if(!e||!e.call)return new o(p(n));try{e.call(this,void 0,new o(p(n)))}catch(n){e(n)}};var _,x=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],b=function(n){t[n]=function(){y("sorry,",n,"is not implemented yet")}};for(_ in x)b(x[_],_)}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(n,e,t){(function(t,r,o,a,i,c,l,s,u){var f=n("./helpers");function d(n,e){n[e>>5]|=128<<e%32,n[14+(e+64>>>9<<4)]=e;for(var t=1732584193,r=-271733879,o=-1732584194,a=271733878,i=0;i<n.length;i+=16){var c=t,l=r,s=o,u=a;t=m(t,r,o,a,n[i+0],7,-680876936),a=m(a,t,r,o,n[i+1],12,-389564586),o=m(o,a,t,r,n[i+2],17,606105819),r=m(r,o,a,t,n[i+3],22,-1044525330),t=m(t,r,o,a,n[i+4],7,-176418897),a=m(a,t,r,o,n[i+5],12,1200080426),o=m(o,a,t,r,n[i+6],17,-1473231341),r=m(r,o,a,t,n[i+7],22,-45705983),t=m(t,r,o,a,n[i+8],7,1770035416),a=m(a,t,r,o,n[i+9],12,-1958414417),o=m(o,a,t,r,n[i+10],17,-42063),r=m(r,o,a,t,n[i+11],22,-1990404162),t=m(t,r,o,a,n[i+12],7,1804603682),a=m(a,t,r,o,n[i+13],12,-40341101),o=m(o,a,t,r,n[i+14],17,-1502002290),t=v(t,r=m(r,o,a,t,n[i+15],22,1236535329),o,a,n[i+1],5,-165796510),a=v(a,t,r,o,n[i+6],9,-1069501632),o=v(o,a,t,r,n[i+11],14,643717713),r=v(r,o,a,t,n[i+0],20,-373897302),t=v(t,r,o,a,n[i+5],5,-701558691),a=v(a,t,r,o,n[i+10],9,38016083),o=v(o,a,t,r,n[i+15],14,-660478335),r=v(r,o,a,t,n[i+4],20,-405537848),t=v(t,r,o,a,n[i+9],5,568446438),a=v(a,t,r,o,n[i+14],9,-1019803690),o=v(o,a,t,r,n[i+3],14,-187363961),r=v(r,o,a,t,n[i+8],20,1163531501),t=v(t,r,o,a,n[i+13],5,-1444681467),a=v(a,t,r,o,n[i+2],9,-51403784),o=v(o,a,t,r,n[i+7],14,1735328473),t=h(t,r=v(r,o,a,t,n[i+12],20,-1926607734),o,a,n[i+5],4,-378558),a=h(a,t,r,o,n[i+8],11,-2022574463),o=h(o,a,t,r,n[i+11],16,1839030562),r=h(r,o,a,t,n[i+14],23,-35309556),t=h(t,r,o,a,n[i+1],4,-1530992060),a=h(a,t,r,o,n[i+4],11,1272893353),o=h(o,a,t,r,n[i+7],16,-155497632),r=h(r,o,a,t,n[i+10],23,-1094730640),t=h(t,r,o,a,n[i+13],4,681279174),a=h(a,t,r,o,n[i+0],11,-358537222),o=h(o,a,t,r,n[i+3],16,-722521979),r=h(r,o,a,t,n[i+6],23,76029189),t=h(t,r,o,a,n[i+9],4,-640364487),a=h(a,t,r,o,n[i+12],11,-421815835),o=h(o,a,t,r,n[i+15],16,530742520),t=g(t,r=h(r,o,a,t,n[i+2],23,-995338651),o,a,n[i+0],6,-198630844),a=g(a,t,r,o,n[i+7],10,1126891415),o=g(o,a,t,r,n[i+14],15,-1416354905),r=g(r,o,a,t,n[i+5],21,-57434055),t=g(t,r,o,a,n[i+12],6,1700485571),a=g(a,t,r,o,n[i+3],10,-1894986606),o=g(o,a,t,r,n[i+10],15,-1051523),r=g(r,o,a,t,n[i+1],21,-2054922799),t=g(t,r,o,a,n[i+8],6,1873313359),a=g(a,t,r,o,n[i+15],10,-30611744),o=g(o,a,t,r,n[i+6],15,-1560198380),r=g(r,o,a,t,n[i+13],21,1309151649),t=g(t,r,o,a,n[i+4],6,-145523070),a=g(a,t,r,o,n[i+11],10,-1120210379),o=g(o,a,t,r,n[i+2],15,718787259),r=g(r,o,a,t,n[i+9],21,-343485551),t=y(t,c),r=y(r,l),o=y(o,s),a=y(a,u)}return Array(t,r,o,a)}function p(n,e,t,r,o,a){return y((e=y(y(e,n),y(r,a)))<<o|e>>>32-o,t)}function m(n,e,t,r,o,a,i){return p(e&t|~e&r,n,e,o,a,i)}function v(n,e,t,r,o,a,i){return p(e&r|t&~r,n,e,o,a,i)}function h(n,e,t,r,o,a,i){return p(e^t^r,n,e,o,a,i)}function g(n,e,t,r,o,a,i){return p(t^(e|~r),n,e,o,a,i)}function y(n,e){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}e.exports=function(n){return f.hash(n,d,16)}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(n,e,t){(function(n,t,r,o,a,i,c,l,s){var u;e.exports=u||function(n){for(var e,t=new Array(n),r=0;r<n;r++)0==(3&r)&&(e=4294967296*Math.random()),t[r]=e>>>((3&r)<<3)&255;return t}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(n,e,t){(function(t,r,o,a,i,c,l,s,u){var f=n("./helpers");function d(n,e){n[e>>5]|=128<<24-e%32,n[15+(e+64>>9<<4)]=e;for(var t,r,o,a=Array(80),i=1732584193,c=-271733879,l=-1732584194,s=271733878,u=-1009589776,f=0;f<n.length;f+=16){for(var d=i,v=c,h=l,g=s,y=u,_=0;_<80;_++){a[_]=_<16?n[f+_]:m(a[_-3]^a[_-8]^a[_-14]^a[_-16],1);var x=p(p(m(i,5),(x=c,r=l,o=s,(t=_)<20?x&r|~x&o:!(t<40)&&t<60?x&r|x&o|r&o:x^r^o)),p(p(u,a[_]),(t=_)<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514));u=s,s=l,l=m(c,30),c=i,i=x}i=p(i,d),c=p(c,v),l=p(l,h),s=p(s,g),u=p(u,y)}return Array(i,c,l,s,u)}function p(n,e){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}function m(n,e){return n<<e|n>>>32-e}e.exports=function(n){return f.hash(n,d,20,!0)}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(n,e,t){(function(t,r,o,a,i,c,l,s,u){function f(n,e){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}function d(n,e){var t,r=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),o=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),a=new Array(64);n[e>>5]|=128<<24-e%32,n[15+(e+64>>9<<4)]=e;for(var i,c,l=0;l<n.length;l+=16){for(var s=o[0],u=o[1],d=o[2],p=o[3],h=o[4],g=o[5],y=o[6],_=o[7],x=0;x<64;x++)a[x]=x<16?n[x+l]:f(f(f((c=a[x-2],m(c,17)^m(c,19)^v(c,10)),a[x-7]),(c=a[x-15],m(c,7)^m(c,18)^v(c,3))),a[x-16]),t=f(f(f(f(_,m(c=h,6)^m(c,11)^m(c,25)),h&g^~h&y),r[x]),a[x]),i=f(m(i=s,2)^m(i,13)^m(i,22),s&u^s&d^u&d),_=y,y=g,g=h,h=f(p,t),p=d,d=u,u=s,s=f(t,i);o[0]=f(s,o[0]),o[1]=f(u,o[1]),o[2]=f(d,o[2]),o[3]=f(p,o[3]),o[4]=f(h,o[4]),o[5]=f(g,o[5]),o[6]=f(y,o[6]),o[7]=f(_,o[7])}return o}var p=n("./helpers"),m=function(n,e){return n>>>e|n<<32-e},v=function(n,e){return n>>>e};e.exports=function(n){return p.hash(n,d,32,!0)}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(n,e,t){(function(n,e,r,o,a,i,c,l,s){t.read=function(n,e,t,r,o){var a,i,c=8*o-r-1,l=(1<<c)-1,s=l>>1,u=-7,f=t?o-1:0,d=t?-1:1;for(o=n[e+f],f+=d,a=o&(1<<-u)-1,o>>=-u,u+=c;0<u;a=256*a+n[e+f],f+=d,u-=8);for(i=a&(1<<-u)-1,a>>=-u,u+=r;0<u;i=256*i+n[e+f],f+=d,u-=8);if(0===a)a=1-s;else{if(a===l)return i?NaN:1/0*(o?-1:1);i+=Math.pow(2,r),a-=s}return(o?-1:1)*i*Math.pow(2,a-r)},t.write=function(n,e,t,r,o,a){var i,c,l=8*a-o-1,s=(1<<l)-1,u=s>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1;for(a=e<0||0===e&&1/e<0?1:0,e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,i=s):(i=Math.floor(Math.log(e)/Math.LN2),e*(r=Math.pow(2,-i))<1&&(i--,r*=2),2<=(e+=1<=i+u?f/r:f*Math.pow(2,1-u))*r&&(i++,r/=2),s<=i+u?(c=0,i=s):1<=i+u?(c=(e*r-1)*Math.pow(2,o),i+=u):(c=e*Math.pow(2,u-1)*Math.pow(2,o),i=0));8<=o;n[t+d]=255&c,d+=p,c/=256,o-=8);for(i=i<<o|c,l+=o;0<l;n[t+d]=255&i,d+=p,i/=256,l-=8);n[t+d-p]|=128*a}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(n,e,t){(function(n,t,r,o,a,i,c,l,s){var u,f,d;function p(){}(n=e.exports={}).nextTick=(f="undefined"!=typeof window&&window.setImmediate,d="undefined"!=typeof window&&window.postMessage&&window.addEventListener,f?function(n){return window.setImmediate(n)}:d?(u=[],window.addEventListener("message",(function(n){var e=n.source;e!==window&&null!==e||"process-tick"!==n.data||(n.stopPropagation(),0<u.length&&u.shift()())}),!0),function(n){u.push(n),window.postMessage("process-tick","*")}):function(n){setTimeout(n,0)}),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.binding=function(n){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(n){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)},5312:function(n,e,t){"use strict";t.d(e,{Z:function(){return S}});var r,o,a=t(1413),i=t(4925),c=t(5671),l=t(3144),s=t(136),u=t(9388),f=t(4942),d=t(7760),p=t(4101),m=t.n(p),v=["baseMaterial","fragmentShader","vertexShader","uniforms","cacheKey"],h="csm_Position",g="csm_PositionRaw",y="csm_Emissive",_="csm_Normal",x="csm_PointSize",b="csm_DiffuseColor",w="csm_FragColor",z=(r={},(0,f.Z)(r,"".concat(_),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(_,";\n    #ifdef USE_TANGENT\n\t    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),(0,f.Z)(r,"".concat(h),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(h,";\n  ")}),(0,f.Z)(r,"".concat(g),{"#include <begin_vertex>":"\n    vec4 csm_positionUnprojected = ".concat(g,";\n    mat4x4 csm_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_unprojectMatrix = csm_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_positionUnprojected = inverse(csm_unprojectMatrix) * csm_positionUnprojected;\n    vec3 transformed = csm_positionUnprojected.xyz;\n  ")}),(0,f.Z)(r,"".concat(x),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(x,";\n    ")}),r),P=(o={},(0,f.Z)(o,"".concat(b),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(b,";\n  ")}),(0,f.Z)(o,"".concat(w),{"#include <output_fragment>":"\n    #include <output_fragment>\n    gl_FragColor  = ".concat(w,";\n  ")}),(0,f.Z)(o,"".concat(y),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(y,";\n    ")}),o),S=function(n){(0,s.Z)(t,n);var e=(0,u.Z)(t);function t(n){var r,o=n.baseMaterial,a=n.fragmentShader,l=n.vertexShader,s=n.uniforms,u=n.cacheKey,f=(0,i.Z)(n,v);(0,c.Z)(this,t);var d=new o(f);for(var p in(r=e.call(this)).uniforms=s||{},d){var m=p;p.startsWith("_")&&(m=p.split("_")[1]),void 0===r[m]&&(r[m]=0),r[m]=d[m]}return r.update({fragmentShader:a,vertexShader:l,uniforms:s,cacheKey:u}),r}return(0,l.Z)(t,[{key:"update",value:function(n){var e=n.fragmentShader,t=n.vertexShader,r=n.uniforms,o=n.cacheKey,a=Object.values(r||{}).forEach((function(n){var e=n.value;return JSON.stringify(e)}));this.uuid=(null==o?void 0:o())||m()([e,t,a]),this.generateMaterial({fragmentShader:e,vertexShader:t,uniforms:r})}},{key:"generateMaterial",value:function(n){var e=this,t=n.fragmentShader,r=n.vertexShader,o=n.uniforms,i=this.parseShader(t),c=this.parseShader(r);this.uniforms=o||{},this.customProgramCacheKey=function(){return e.uuid},this.onBeforeCompile=function(n){if(i){var t=e.patchShader(i,n.fragmentShader,P);n.fragmentShader=t}if(c){var r=e.patchShader(c,n.vertexShader,z);n.vertexShader="#define IS_VERTEX;\n"+r}n.uniforms=(0,a.Z)((0,a.Z)({},n.uniforms),e.uniforms),e.uniforms=n.uniforms},this.needsUpdate=!0}},{key:"patchShader",value:function(n,e,t){var r=e;return Object.keys(t).forEach((function(e){Object.keys(t[e]).forEach((function(o){var a,i,c;(function(n,e){return new RegExp("\\b".concat((t=e,t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")),"\\b")).test(n);var t})(n.main,e)&&(a=r,i=o,c=t[e][o],r=a.split(i).join(c))}))})),r=r.replace("void main() {","\n          ".concat(n.header,"\n          void main() {\n            vec3 csm_Position;\n            vec4 csm_PositionRaw;\n            vec3 csm_Normal;\n            vec3 csm_Emissive;\n\n            #ifdef IS_VERTEX\n              csm_Position = position;\n              csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n            #endif\n\n            #ifdef IS_VERTEX\n              csm_Normal = normal;\n            #endif\n            \n            #ifndef IS_VERTEX\n              #ifdef STANDARD\n                csm_Emissive = emissive;\n              #endif\n            #endif\n\n            vec4 csm_DiffuseColor = vec4(1., 0., 0., 1.);\n            vec4 csm_FragColor = vec4(1., 0., 0., 1.);\n            float csm_PointSize = 1.;\n\n            ").concat(n.main,"\n          ")),r=n.defines+r}},{key:"parseShader",value:function(n){if(n){var e={defines:"",header:"",main:""},t=n.match(/^(\s*)(void\s*main\s*\(.*\)\s*).*?{[\s\S]*?^\1}\s*$/gm);if(null!=t&&t.length){var r=t[0].match(/{[\w\W\s\S]*}/gm);null!=r&&r.length&&(e.main=r[0]);var o=n.replace(t[0],""),a=o.match(/#(.*?;)/g)||[],i=a.reduce((function(n,e){return n.replace(e,"")}),o);e.header=i,e.defines=a.join("\n")}return e}}}]),t}(d.Material)}}]);
//# sourceMappingURL=2194.587a4d5c.chunk.js.map