"use strict";(self.webpackChunkr3f_examples=self.webpackChunkr3f_examples||[]).push([[282],{1367:function(e,t,r){r.r(t),r.d(t,{default:function(){return G}});var n=r(2791),a=r(4150),o=r(9439),i=r(4925),s=r(7462),c=r(7760),u=r(7219),l=r(5671),d=r(3144),m=r(1752),f=r(1120),h=r(136),p=r(9388),v=function(e){(0,h.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,l.Z)(this,r),(n=t.call(this,e)).type=c.HalfFloatType,n}return(0,d.Z)(r,[{key:"parse",value:function(e){var t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},r=function(e,t,r){t=t||1024;for(var n=e.pos,a=-1,o=0,i="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));0>(a=s.indexOf("\n"))&&o<t&&n<e.byteLength;)i+=s,o+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return-1<a&&(!1!==r&&(e.pos+=o+a+1),i+s.slice(0,a))},n=function(e,t,r,n){var a=e[t+3],o=Math.pow(2,a-128)/255;r[n+0]=e[t+0]*o,r[n+1]=e[t+1]*o,r[n+2]=e[t+2]*o,r[n+3]=1},a=function(e,t,r,n){var a=e[t+3],o=Math.pow(2,a-128)/255;r[n+0]=c.DataUtils.toHalfFloat(Math.min(e[t+0]*o,65504)),r[n+1]=c.DataUtils.toHalfFloat(Math.min(e[t+1]*o,65504)),r[n+2]=c.DataUtils.toHalfFloat(Math.min(e[t+2]*o,65504)),r[n+3]=c.DataUtils.toHalfFloat(1)},o=new Uint8Array(e);o.pos=0;var i=function(e){var n,a,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,c=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(n=r(e)))return t(1,"no header found");if(!(a=n.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(u.valid|=1,u.programtype=a[1],u.string+=n+"\n";!1!==(n=r(e));)if(u.string+=n+"\n","#"!==n.charAt(0)){if((a=n.match(o))&&(u.gamma=parseFloat(a[1])),(a=n.match(i))&&(u.exposure=parseFloat(a[1])),(a=n.match(s))&&(u.valid|=2,u.format=a[1]),(a=n.match(c))&&(u.valid|=4,u.height=parseInt(a[1],10),u.width=parseInt(a[2],10)),2&u.valid&&4&u.valid)break}else u.comments+=n+"\n";return 2&u.valid?4&u.valid?u:t(3,"missing image size specifier"):t(3,"missing format specifier")}(o);if(-1!==i){var s=i.width,u=i.height,l=function(e,r,n){var a=r;if(a<8||a>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(a!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");var o=new Uint8Array(4*r*n);if(!o.length)return t(4,"unable to allocate buffer space");for(var i=0,s=0,c=4*a,u=new Uint8Array(4),l=new Uint8Array(c),d=n;d>0&&s<e.byteLength;){if(s+4>e.byteLength)return t(1);if(u[0]=e[s++],u[1]=e[s++],u[2]=e[s++],u[3]=e[s++],2!=u[0]||2!=u[1]||(u[2]<<8|u[3])!=a)return t(3,"bad rgbe scanline format");for(var m=0,f=void 0;m<c&&s<e.byteLength;){var h=(f=e[s++])>128;if(h&&(f-=128),0===f||m+f>c)return t(3,"bad scanline data");if(h)for(var p=e[s++],v=0;v<f;v++)l[m++]=p;else l.set(e.subarray(s,s+f),m),m+=f,s+=f}for(var g=a,y=0;y<g;y++){var w=0;o[i]=l[y+w],w+=a,o[i+1]=l[y+w],w+=a,o[i+2]=l[y+w],w+=a,o[i+3]=l[y+w],i+=4}d--}return o}(o.subarray(o.pos),s,u);if(-1!==l){var d,m,f;switch(this.type){case c.FloatType:f=l.length/4;for(var h=new Float32Array(4*f),p=0;p<f;p++)n(l,4*p,h,4*p);d=h,m=c.FloatType;break;case c.HalfFloatType:f=l.length/4;for(var v=new Uint16Array(4*f),g=0;g<f;g++)a(l,4*g,v,4*g);d=v,m=c.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:s,height:u,data:d,header:i.string,gamma:i.gamma,exposure:i.exposure,format:undefined,type:m}}}return null}},{key:"setDataType",value:function(e){return this.type=e,this}},{key:"load",value:function(e,t,n,a){return(0,m.Z)((0,f.Z)(r.prototype),"load",this).call(this,e,(function(e,r){switch(e.type){case c.FloatType:case c.HalfFloatType:e.encoding=c.LinearEncoding,e.minFilter=c.LinearFilter,e.magFilter=c.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)}),n,a)}}]),r}(c.DataTextureLoader),g={sunset:"venice/venice_sunset_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",night:"dikhololo/dikhololo_night_1k.hdr",warehouse:"empty-wharehouse/empty_warehouse_01_1k.hdr",forest:"forrest-slope/forest_slope_1k.hdr",apartment:"lebombo/lebombo_1k.hdr",studio:"studio-small-3/studio_small_03_1k.hdr",city:"potsdamer-platz/potsdamer_platz_1k.hdr",park:"rooitou/rooitou_park_1k.hdr",lobby:"st-fagans/st_fagans_interior_1k.hdr"},y=["args","children"];function w(e){var t=e+"BufferGeometry";return n.forwardRef((function(e,r){var a=e.args,o=e.children,c=(0,i.Z)(e,y);return n.createElement("mesh",(0,s.Z)({ref:r},c),n.createElement(t,{attach:"geometry",args:a}),o)}))}w("box"),w("circle"),w("cone"),w("cylinder"),w("sphere"),w("plane"),w("tube"),w("torus"),w("torusKnot"),w("tetrahedron"),w("ring"),w("polyhedron");var b=w("icosahedron"),E=(w("octahedron"),w("dodecahedron"),w("extrude"),w("lathe"),["background","scene"]),x=function(e){return(t=e).current&&t.current.isScene?e.current:e;var t};function M(e){var t=e.scene,r=e.background,a=void 0!==r&&r,o=e.map,i=(0,u.w)((function(e){return e.scene}));return n.useLayoutEffect((function(){if(o){var e=x(t||i),r=e.background,n=e.environment;return"only"!==a&&(e.environment=o),a&&(e.background=o),function(){"only"!==a&&(e.environment=n),a&&(e.background=r)}}}),[i,t,o,a]),null}function _(e){var t=e.files,r=void 0===t?["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"]:t,n=e.path,a=void 0===n?"":n,o=e.preset,i=void 0===o?void 0:o,s=e.extensions;if(i){if(!(i in g))throw new Error("Preset must be one of: "+Object.keys(g).join(", "));r=g[i],a="https://market-assets.fra1.cdn.digitaloceanspaces.com/market-assets/hdris/"}var l=Array.isArray(r),d=l?c.CubeTextureLoader:v,m=(0,u.z)(d,l?[r]:r,(function(e){e.setPath(a),s&&s(e)})),f=l?m[0]:m;return f.mapping=l?c.CubeReflectionMapping:c.EquirectangularReflectionMapping,f}function k(e){var t=e.background,r=void 0!==t&&t,a=e.scene,o=_((0,i.Z)(e,E)),s=(0,u.w)((function(e){return e.scene}));return n.useLayoutEffect((function(){var e=x(a||s),t=e.background,n=e.environment;return"only"!==r&&(e.environment=o),r&&(e.background=o),function(){"only"!==r&&(e.environment=n),r&&(e.background=t)}}),[o,r,a,s]),null}function S(e){var t=e.children,r=e.near,a=void 0===r?1:r,i=e.far,s=void 0===i?1e3:i,l=e.resolution,d=void 0===l?256:l,m=e.frames,f=void 0===m?1:m,h=e.map,p=e.background,v=void 0!==p&&p,g=e.scene,y=e.files,w=e.path,b=e.preset,E=void 0===b?void 0:b,_=e.extensions,S=(0,u.w)((function(e){return e.gl})),L=(0,u.w)((function(e){return e.scene})),j=n.useRef(null),F=n.useState((function(){return new c.Scene})),P=(0,o.Z)(F,1)[0],U=n.useMemo((function(){var e=new c.WebGLCubeRenderTarget(d);return e.texture.type=c.HalfFloatType,e}),[d]);n.useLayoutEffect((function(){1===f&&j.current.update(S,P);var e=x(g||L),t=e.background,r=e.environment;return"only"!==v&&(e.environment=U.texture),v&&(e.background=U.texture),function(){"only"!==v&&(e.environment=r),v&&(e.background=t)}}),[t,P,U.texture,g,L,v,f,S]);var T=1;return(0,u.x)((function(){(f===1/0||T<f)&&(j.current.update(S,P),T++)})),n.createElement(n.Fragment,null,(0,u.g)(n.createElement(n.Fragment,null,t,n.createElement("cubeCamera",{ref:j,args:[a,s,U]}),y||E?n.createElement(k,{background:!0,files:y,preset:E,path:w,extensions:_}):h?n.createElement(M,{background:!0,map:h,extensions:_}):null),P))}function L(e){var t,r,a,o,i,u=_(e),l=e.map||u,d=(i=l)&&i.isCubeTexture,m=n.useMemo((function(){var e,t,r=(null!==(e=d?null==(t=l.image[0])?void 0:t.width:l.image.width)&&void 0!==e?e:1024)/4,n=Math.floor(Math.log2(r)),a=Math.pow(2,n),o=3*Math.max(a,112),i=4*a;return[d?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH ".concat(1/o),"#define CUBEUV_TEXEL_HEIGHT ".concat(1/i),"#define CUBEUV_MAX_MIP ".concat(n,".0"),""]}),[]),f=n.useMemo((function(){return m.join("\n")+"#define GLSLIFY 1\n#define ENVMAP_TYPE_CUBE_UV\nvarying vec3 vWorldPosition;uniform float radius;uniform float height;\n#ifdef ENVMAP_TYPE_CUBE\nuniform samplerCube cubemap;\n#else\nuniform sampler2D cubemap;\n#endif\nfloat diskIntersect(in vec3 ro,in vec3 rd,vec3 c,vec3 n,float r){vec3 o=ro-c;float t=-dot(n,o)/dot(rd,n);vec3 q=o+rd*t;return(dot(q,q)<r*r)? t : 1e6;}float sphereIntersect(in vec3 ro,in vec3 rd,in vec3 ce,float ra){vec3 oc=ro-ce;float b=dot(oc,rd);float c=dot(oc,oc)-ra*ra;float h=b*b-c;if(h<0.0)-1.0;h=sqrt(h);return-b+h;}vec3 project(){vec3 p=normalize(vWorldPosition);vec3 camPos=cameraPosition;camPos.y-=height;float intersection=sphereIntersect(camPos,p,vec3(0.),radius);if(intersection>0.){vec3 h=vec3(0.0,-height,0.0);float intersection2=diskIntersect(camPos,p,h,vec3(0.0,-1.0,0.0),radius);p=(camPos+min(intersection,intersection2)*p)/radius;}else{p=vec3(0.0,1.0,0.0);}return p;}\n#include <common>\n#include <cube_uv_reflection_fragment>\nvoid main(){vec3 projectedWorldPosition=project();\n#ifdef ENVMAP_TYPE_CUBE\nvec3 outcolor=textureCube(cubemap,projectedWorldPosition).rgb;\n#else\nvec3 direction=normalize(projectedWorldPosition);vec2 uv=equirectUv(direction);vec3 outcolor=texture2D(cubemap,uv).rgb;\n#endif\ngl_FragColor=vec4(outcolor,1.0);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n}"}),[m]),h=n.useMemo((function(){return{cubemap:{value:null},height:{value:15},radius:{value:60}}}),[]),p=n.useRef(null),v=null==(t=e.ground)?void 0:t.height,g=null==(r=e.ground)?void 0:r.radius,y=null!==(a=null==(o=e.ground)?void 0:o.scale)&&void 0!==a?a:1e3;return n.useEffect((function(){v&&(p.current.uniforms.height.value=v)}),[v]),n.useEffect((function(){g&&(p.current.uniforms.radius.value=g)}),[g]),n.useEffect((function(){p.current.uniforms.cubemap.value=l}),[l]),n.createElement(n.Fragment,null,n.createElement(M,(0,s.Z)({},e,{map:l})),n.createElement(b,{scale:y,args:[1,16]},n.createElement("shaderMaterial",{ref:p,side:c.BackSide,vertexShader:"#define GLSLIFY 1\nvarying vec3 vWorldPosition;void main(){vec4 worldPosition=modelMatrix*vec4(position,1.0);vWorldPosition=worldPosition.xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",fragmentShader:f,uniforms:h,depthTest:!1})))}function j(e){return e.ground?n.createElement(L,e):e.map?n.createElement(M,e):e.children?n.createElement(S,e):n.createElement(k,e)}var F=r(8202),P=["children","controls","shadows","adjustCamera","environment","intensity","preset","shadowBias","contactShadow"],U={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function T(e){var t=e.children,r=e.controls,a=e.shadows,l=void 0===a||a,d=e.adjustCamera,m=void 0===d||d,f=e.environment,h=void 0===f?"city":f,p=e.intensity,v=void 0===p?1:p,g=e.preset,y=void 0===g?"rembrandt":g,w=e.shadowBias,b=void 0===w?0:w,E=e.contactShadow,x=void 0===E?{blur:2,opacity:.5,position:[0,0,0]}:E,M=(0,i.Z)(e,P),_=U[y],k=(0,u.w)((function(e){return e.camera})),S=(0,u.w)((function(e){return e.controls})),L=n.useRef(null),T=n.useRef(null),C=n.useState({radius:0,width:0,height:0}),R=(0,o.Z)(C,2),A=R[0],B=A.radius,I=A.width,H=A.height,Z=R[1];return n.useLayoutEffect((function(){L.current.position.set(0,0,0),L.current.updateWorldMatrix(!0,!0);var e=(new c.Box3).setFromObject(T.current),t=new c.Vector3,r=new c.Sphere,n=e.max.y-e.min.y,a=e.max.x-e.min.x;e.getCenter(t),e.getBoundingSphere(r),Z({radius:r.radius,width:a,height:n}),L.current.position.set(-t.x,-t.y+n/2,-t.z)}),[t]),n.useLayoutEffect((function(){if(m){var e=B/(H>I?1.5:2.5);k.position.set(0,.5*B,2.5*B),k.near=.1,k.far=Math.max(5e3,4*B),k.lookAt(0,e,0);var t=S||(null==r?void 0:r.current);t&&(t.target.set(0,e,0),t.update())}}),[S,B,H,I,m]),n.createElement("group",M,n.createElement("group",{ref:L},n.createElement("group",{ref:T},t)),x&&n.createElement(F.j,(0,s.Z)({scale:2*B,far:B/2},x)),h&&n.createElement(j,{preset:h}),n.createElement("ambientLight",{intensity:v/3}),n.createElement("spotLight",{penumbra:1,position:[_.main[0]*B,_.main[1]*B,_.main[2]*B],intensity:2*v,castShadow:l,"shadow-bias":b}),n.createElement("pointLight",{position:[_.fill[0]*B,_.fill[1]*B,_.fill[2]*B],intensity:v}))}function C(){var e=(0,u.w)((function(e){return e.gl}));return(0,n.useEffect)((function(){return e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,function(){e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0}}),[e.shadowMap]),null}var R=r(3520),A=r(1413),B=r(3655),I=r.p+"static/media/shoe.175d5ebc5d5e54e1ddff.gltf",H=r(184),Z=["color"];B.L.preload(I);var z=function(e){var t=e.color,r=(0,i.Z)(e,Z),n=(0,B.L)(I),a=n.nodes,o=n.materials;return(0,H.jsxs)("group",(0,A.Z)((0,A.Z)({},r),{},{dispose:null,children:[(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe.geometry,material:o.laces,"material-envMapIntensity":.8}),(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_1.geometry,children:(0,H.jsx)("meshStandardMaterial",{color:t,aoMap:o.mesh.aoMap,normalMap:o.mesh.normalMap,"normalMap-encoding":c.LinearEncoding,roughnessMap:o.mesh.roughnessMap,metalnessMap:o.mesh.metalnessMap,envMapIntensity:.8})}),(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_2.geometry,material:o.caps,"material-envMapIntensity":.8}),(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_3.geometry,material:o.inner,"material-envMapIntensity":.8}),(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_4.geometry,material:o.sole,"material-envMapIntensity":.8}),(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_5.geometry,material:o.stripes,"material-envMapIntensity":.8}),(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_6.geometry,material:o.band,"material-envMapIntensity":.8}),(0,H.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_7.geometry,material:o.patch,"material-envMapIntensity":.8})]}))},G=function(e){var t=e.children;return(0,H.jsxs)(H.Fragment,{children:[t,(0,H.jsxs)(a.Xz,{shadows:!0,dpr:[1,2],camera:{position:[0,0,150],fov:40},children:[(0,H.jsxs)(n.Suspense,{fallback:null,children:[(0,H.jsxs)(T,{environment:"city",intensity:.6,children:[(0,H.jsx)(z,{color:"tomato",position:[0,0,0]}),(0,H.jsx)(z,{color:"orange",scale:-1,rotation:[0,.5,Math.PI],position:[0,0,-2]})]}),(0,H.jsx)(C,{})]}),(0,H.jsx)(R.z,{autoRotate:!0})]})]})}}}]);
//# sourceMappingURL=282.0c032a4c.chunk.js.map