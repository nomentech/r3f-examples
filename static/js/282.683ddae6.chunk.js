"use strict";(self.webpackChunkr3f_examples=self.webpackChunkr3f_examples||[]).push([[282],{1367:function(e,r,t){t.r(r),t.d(r,{default:function(){return W}});var n=t(2791),a=t(4647),o=t(9439),i=t(4925),s=t(7462),u=t(7760),c=t(7219),l=t(5671),v=t(3144),d=t(1752),f=t(1120),m=t(136),h=t(9388),p=function(e){(0,m.Z)(t,e);var r=(0,h.Z)(t);function t(e){var n;return(0,l.Z)(this,t),(n=r.call(this,e)).type=u.HalfFloatType,n}return(0,v.Z)(t,[{key:"parse",value:function(e){var r=function(e,r){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(r||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(r||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(r||""));break;default:console.error("THREE.RGBELoader: Error: "+(r||""))}return-1},t=function(e,r,t){r=r||1024;for(var n=e.pos,a=-1,o=0,i="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));0>(a=s.indexOf("\n"))&&o<r&&n<e.byteLength;)i+=s,o+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return-1<a&&(!1!==t&&(e.pos+=o+a+1),i+s.slice(0,a))},n=function(e,r,t,n){var a=e[r+3],o=Math.pow(2,a-128)/255;t[n+0]=e[r+0]*o,t[n+1]=e[r+1]*o,t[n+2]=e[r+2]*o,t[n+3]=1},a=function(e,r,t,n){var a=e[r+3],o=Math.pow(2,a-128)/255;t[n+0]=u.DataUtils.toHalfFloat(Math.min(e[r+0]*o,65504)),t[n+1]=u.DataUtils.toHalfFloat(Math.min(e[r+1]*o,65504)),t[n+2]=u.DataUtils.toHalfFloat(Math.min(e[r+2]*o,65504)),t[n+3]=u.DataUtils.toHalfFloat(1)},o=new Uint8Array(e);o.pos=0;var i=function(e){var n,a,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,u=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(n=t(e)))return r(1,"no header found");if(!(a=n.match(/^#\?(\S+)/)))return r(3,"bad initial token");for(c.valid|=1,c.programtype=a[1],c.string+=n+"\n";!1!==(n=t(e));)if(c.string+=n+"\n","#"!==n.charAt(0)){if((a=n.match(o))&&(c.gamma=parseFloat(a[1])),(a=n.match(i))&&(c.exposure=parseFloat(a[1])),(a=n.match(s))&&(c.valid|=2,c.format=a[1]),(a=n.match(u))&&(c.valid|=4,c.height=parseInt(a[1],10),c.width=parseInt(a[2],10)),2&c.valid&&4&c.valid)break}else c.comments+=n+"\n";return 2&c.valid?4&c.valid?c:r(3,"missing image size specifier"):r(3,"missing format specifier")}(o);if(-1!==i){var s=i.width,c=i.height,l=function(e,t,n){var a=t;if(a<8||a>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(a!==(e[2]<<8|e[3]))return r(3,"wrong scanline width");var o=new Uint8Array(4*t*n);if(!o.length)return r(4,"unable to allocate buffer space");for(var i=0,s=0,u=4*a,c=new Uint8Array(4),l=new Uint8Array(u),v=n;v>0&&s<e.byteLength;){if(s+4>e.byteLength)return r(1);if(c[0]=e[s++],c[1]=e[s++],c[2]=e[s++],c[3]=e[s++],2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=a)return r(3,"bad rgbe scanline format");for(var d=0,f=void 0;d<u&&s<e.byteLength;){var m=(f=e[s++])>128;if(m&&(f-=128),0===f||d+f>u)return r(3,"bad scanline data");if(m)for(var h=e[s++],p=0;p<f;p++)l[d++]=h;else l.set(e.subarray(s,s+f),d),d+=f,s+=f}for(var g=a,y=0;y<g;y++){var x=0;o[i]=l[y+x],x+=a,o[i+1]=l[y+x],x+=a,o[i+2]=l[y+x],x+=a,o[i+3]=l[y+x],i+=4}v--}return o}(o.subarray(o.pos),s,c);if(-1!==l){var v,d,f;switch(this.type){case u.FloatType:f=l.length/4;for(var m=new Float32Array(4*f),h=0;h<f;h++)n(l,4*h,m,4*h);v=m,d=u.FloatType;break;case u.HalfFloatType:f=l.length/4;for(var p=new Uint16Array(4*f),g=0;g<f;g++)a(l,4*g,p,4*g);v=p,d=u.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:s,height:c,data:v,header:i.string,gamma:i.gamma,exposure:i.exposure,format:undefined,type:d}}}return null}},{key:"setDataType",value:function(e){return this.type=e,this}},{key:"load",value:function(e,r,n,a){return(0,d.Z)((0,f.Z)(t.prototype),"load",this).call(this,e,(function(e,t){switch(e.type){case u.FloatType:case u.HalfFloatType:e.encoding=u.LinearEncoding,e.minFilter=u.LinearFilter,e.magFilter=u.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}r&&r(e,t)}),n,a)}}]),t}(u.DataTextureLoader),g={sunset:"venice/venice_sunset_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",night:"dikhololo/dikhololo_night_1k.hdr",warehouse:"empty-wharehouse/empty_warehouse_01_1k.hdr",forest:"forrest-slope/forest_slope_1k.hdr",apartment:"lebombo/lebombo_1k.hdr",studio:"studio-small-3/studio_small_03_1k.hdr",city:"potsdamer-platz/potsdamer_platz_1k.hdr",park:"rooitou/rooitou_park_1k.hdr",lobby:"st-fagans/st_fagans_interior_1k.hdr"},y=["args","children"];function x(e){var r=e+"BufferGeometry";return n.forwardRef((function(e,t){var a=e.args,o=e.children,u=(0,i.Z)(e,y);return n.createElement("mesh",(0,s.Z)({ref:t},u),n.createElement(r,{attach:"geometry",args:a}),o)}))}x("box"),x("circle"),x("cone"),x("cylinder"),x("sphere"),x("plane"),x("tube"),x("torus"),x("torusKnot"),x("tetrahedron"),x("ring"),x("polyhedron");var w=x("icosahedron"),b=(x("octahedron"),x("dodecahedron"),x("extrude"),x("lathe"),["background","scene"]),E=function(e){return(r=e).current&&r.current.isScene?e.current:e;var r};function M(e){var r=e.scene,t=e.background,a=void 0!==t&&t,o=e.map,i=(0,c.w)((function(e){return e.scene}));return n.useLayoutEffect((function(){if(o){var e=E(r||i),t=e.background,n=e.environment;return"only"!==a&&(e.environment=o),a&&(e.background=o),function(){"only"!==a&&(e.environment=n),a&&(e.background=t)}}}),[i,r,o,a]),null}function U(e){var r=e.files,t=void 0===r?["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"]:r,n=e.path,a=void 0===n?"":n,o=e.preset,i=void 0===o?void 0:o,s=e.extensions;if(i){if(!(i in g))throw new Error("Preset must be one of: "+Object.keys(g).join(", "));t=g[i],a="https://market-assets.fra1.cdn.digitaloceanspaces.com/market-assets/hdris/"}var l=Array.isArray(t),v=l?u.CubeTextureLoader:p,d=(0,c.z)(v,l?[t]:t,(function(e){e.setPath(a),s&&s(e)})),f=l?d[0]:d;return f.mapping=l?u.CubeReflectionMapping:u.EquirectangularReflectionMapping,f}function _(e){var r=e.background,t=void 0!==r&&r,a=e.scene,o=U((0,i.Z)(e,b)),s=(0,c.w)((function(e){return e.scene}));return n.useLayoutEffect((function(){var e=E(a||s),r=e.background,n=e.environment;return"only"!==t&&(e.environment=o),t&&(e.background=o),function(){"only"!==t&&(e.environment=n),t&&(e.background=r)}}),[o,t,a,s]),null}function k(e){var r=e.children,t=e.near,a=void 0===t?1:t,i=e.far,s=void 0===i?1e3:i,l=e.resolution,v=void 0===l?256:l,d=e.frames,f=void 0===d?1:d,m=e.map,h=e.background,p=void 0!==h&&h,g=e.scene,y=e.files,x=e.path,w=e.preset,b=void 0===w?void 0:w,U=e.extensions,k=(0,c.w)((function(e){return e.gl})),D=(0,c.w)((function(e){return e.scene})),S=n.useRef(null),T=n.useState((function(){return new u.Scene})),L=(0,o.Z)(T,1)[0],P=n.useMemo((function(){var e=new u.WebGLCubeRenderTarget(v);return e.texture.type=u.HalfFloatType,e}),[v]);n.useLayoutEffect((function(){1===f&&S.current.update(k,L);var e=E(g||D),r=e.background,t=e.environment;return"only"!==p&&(e.environment=P.texture),p&&(e.background=P.texture),function(){"only"!==p&&(e.environment=t),p&&(e.background=r)}}),[r,L,P.texture,g,D,p,f,k]);var j=1;return(0,c.x)((function(){(f===1/0||j<f)&&(S.current.update(k,L),j++)})),n.createElement(n.Fragment,null,(0,c.g)(n.createElement(n.Fragment,null,r,n.createElement("cubeCamera",{ref:S,args:[a,s,P]}),y||b?n.createElement(_,{background:!0,files:y,preset:b,path:x,extensions:U}):m?n.createElement(M,{background:!0,map:m,extensions:U}):null),L))}function D(e){var r,t,a,o,i,c=U(e),l=e.map||c,v=(i=l)&&i.isCubeTexture,d=n.useMemo((function(){var e,r,t=(null!==(e=v?null==(r=l.image[0])?void 0:r.width:l.image.width)&&void 0!==e?e:1024)/4,n=Math.floor(Math.log2(t)),a=Math.pow(2,n),o=3*Math.max(a,112),i=4*a;return[v?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH ".concat(1/o),"#define CUBEUV_TEXEL_HEIGHT ".concat(1/i),"#define CUBEUV_MAX_MIP ".concat(n,".0"),""]}),[]),f=n.useMemo((function(){return d.join("\n")+"#define GLSLIFY 1\n#define ENVMAP_TYPE_CUBE_UV\nvarying vec3 vWorldPosition;uniform float radius;uniform float height;\n#ifdef ENVMAP_TYPE_CUBE\nuniform samplerCube cubemap;\n#else\nuniform sampler2D cubemap;\n#endif\nfloat diskIntersect(in vec3 ro,in vec3 rd,vec3 c,vec3 n,float r){vec3 o=ro-c;float t=-dot(n,o)/dot(rd,n);vec3 q=o+rd*t;return(dot(q,q)<r*r)? t : 1e6;}float sphereIntersect(in vec3 ro,in vec3 rd,in vec3 ce,float ra){vec3 oc=ro-ce;float b=dot(oc,rd);float c=dot(oc,oc)-ra*ra;float h=b*b-c;if(h<0.0)-1.0;h=sqrt(h);return-b+h;}vec3 project(){vec3 p=normalize(vWorldPosition);vec3 camPos=cameraPosition;camPos.y-=height;float intersection=sphereIntersect(camPos,p,vec3(0.),radius);if(intersection>0.){vec3 h=vec3(0.0,-height,0.0);float intersection2=diskIntersect(camPos,p,h,vec3(0.0,-1.0,0.0),radius);p=(camPos+min(intersection,intersection2)*p)/radius;}else{p=vec3(0.0,1.0,0.0);}return p;}\n#include <common>\n#include <cube_uv_reflection_fragment>\nvoid main(){vec3 projectedWorldPosition=project();\n#ifdef ENVMAP_TYPE_CUBE\nvec3 outcolor=textureCube(cubemap,projectedWorldPosition).rgb;\n#else\nvec3 direction=normalize(projectedWorldPosition);vec2 uv=equirectUv(direction);vec3 outcolor=texture2D(cubemap,uv).rgb;\n#endif\ngl_FragColor=vec4(outcolor,1.0);\n#include <tonemapping_fragment>\n#include <encodings_fragment>\n}"}),[d]),m=n.useMemo((function(){return{cubemap:{value:null},height:{value:15},radius:{value:60}}}),[]),h=n.useRef(null),p=null==(r=e.ground)?void 0:r.height,g=null==(t=e.ground)?void 0:t.radius,y=null!==(a=null==(o=e.ground)?void 0:o.scale)&&void 0!==a?a:1e3;return n.useEffect((function(){p&&(h.current.uniforms.height.value=p)}),[p]),n.useEffect((function(){g&&(h.current.uniforms.radius.value=g)}),[g]),n.useEffect((function(){h.current.uniforms.cubemap.value=l}),[l]),n.createElement(n.Fragment,null,n.createElement(M,(0,s.Z)({},e,{map:l})),n.createElement(w,{scale:y,args:[1,16]},n.createElement("shaderMaterial",{ref:h,side:u.BackSide,vertexShader:"#define GLSLIFY 1\nvarying vec3 vWorldPosition;void main(){vec4 worldPosition=modelMatrix*vec4(position,1.0);vWorldPosition=worldPosition.xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",fragmentShader:f,uniforms:m,depthTest:!1})))}function S(e){return e.ground?n.createElement(D,e):e.map?n.createElement(M,e):e.children?n.createElement(k,e):n.createElement(_,e)}var T=t(8202),L=["children","controls","shadows","adjustCamera","environment","intensity","preset","shadowBias","contactShadow"],P={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function j(e){var r=e.children,t=e.controls,a=e.shadows,l=void 0===a||a,v=e.adjustCamera,d=void 0===v||v,f=e.environment,m=void 0===f?"city":f,h=e.intensity,p=void 0===h?1:h,g=e.preset,y=void 0===g?"rembrandt":g,x=e.shadowBias,w=void 0===x?0:x,b=e.contactShadow,E=void 0===b?{blur:2,opacity:.5,position:[0,0,0]}:b,M=(0,i.Z)(e,L),U=P[y],_=(0,c.w)((function(e){return e.camera})),k=(0,c.w)((function(e){return e.controls})),D=n.useRef(null),j=n.useRef(null),F=n.useState({radius:0,width:0,height:0}),R=(0,o.Z)(F,2),C=R[0],A=C.radius,B=C.width,Z=C.height,I=R[1];return n.useLayoutEffect((function(){D.current.position.set(0,0,0),D.current.updateWorldMatrix(!0,!0);var e=(new u.Box3).setFromObject(j.current),r=new u.Vector3,t=new u.Sphere,n=e.max.y-e.min.y,a=e.max.x-e.min.x;e.getCenter(r),e.getBoundingSphere(t),I({radius:t.radius,width:a,height:n}),D.current.position.set(-r.x,-r.y+n/2,-r.z)}),[r]),n.useLayoutEffect((function(){if(d){var e=A/(Z>B?1.5:2.5);_.position.set(0,.5*A,2.5*A),_.near=.1,_.far=Math.max(5e3,4*A),_.lookAt(0,e,0);var r=k||(null==t?void 0:t.current);r&&(r.target.set(0,e,0),r.update())}}),[k,A,Z,B,d]),n.createElement("group",M,n.createElement("group",{ref:D},n.createElement("group",{ref:j},r)),E&&n.createElement(T.j,(0,s.Z)({scale:2*A,far:A/2},E)),m&&n.createElement(S,{preset:m}),n.createElement("ambientLight",{intensity:p/3}),n.createElement("spotLight",{penumbra:1,position:[U.main[0]*A,U.main[1]*A,U.main[2]*A],intensity:2*p,castShadow:l,"shadow-bias":w}),n.createElement("pointLight",{position:[U.fill[0]*A,U.fill[1]*A,U.fill[2]*A],intensity:p}))}function F(){var e=(0,c.w)((function(e){return e.gl}));return(0,n.useEffect)((function(){return e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,function(){e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0}}),[e.shadowMap]),null}var R=t(3520),C=t(1413),A=t(3655),B=t.p+"static/media/shoe.175d5ebc5d5e54e1ddff.gltf",Z=t(184),I=["color"];A.L.preload(B);var H=function(e){var r=e.color,t=(0,i.Z)(e,I),n=(0,A.L)(B),a=n.nodes,o=n.materials;return(0,Z.jsxs)("group",(0,C.Z)((0,C.Z)({},t),{},{dispose:null,children:[(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe.geometry,material:o.laces,"material-envMapIntensity":.8}),(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_1.geometry,children:(0,Z.jsx)("meshStandardMaterial",{color:r,aoMap:o.mesh.aoMap,normalMap:o.mesh.normalMap,"normalMap-encoding":u.LinearEncoding,roughnessMap:o.mesh.roughnessMap,metalnessMap:o.mesh.metalnessMap,envMapIntensity:.8})}),(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_2.geometry,material:o.caps,"material-envMapIntensity":.8}),(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_3.geometry,material:o.inner,"material-envMapIntensity":.8}),(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_4.geometry,material:o.sole,"material-envMapIntensity":.8}),(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_5.geometry,material:o.stripes,"material-envMapIntensity":.8}),(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_6.geometry,material:o.band,"material-envMapIntensity":.8}),(0,Z.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:a.shoe_7.geometry,material:o.patch,"material-envMapIntensity":.8})]}))},W=function(e){var r=e.children;return(0,Z.jsxs)(Z.Fragment,{children:[r,(0,Z.jsxs)(a.Xz,{shadows:!0,dpr:[1,2],camera:{position:[0,0,150],fov:40},children:[(0,Z.jsxs)(n.Suspense,{fallback:null,children:[(0,Z.jsxs)(j,{environment:"city",intensity:.6,children:[(0,Z.jsx)(H,{color:"tomato",position:[0,0,0]}),(0,Z.jsx)(H,{color:"orange",scale:-1,rotation:[0,.5,Math.PI],position:[0,0,-2]})]}),(0,Z.jsx)(F,{})]}),(0,Z.jsx)(R.z,{autoRotate:!0})]})]})}},8202:function(e,r,t){t.d(r,{j:function(){return f}});var n=t(1413),a=t(9439),o=t(4925),i=t(7462),s=t(2791),u=t(7760),c=t(7219),l={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},v={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "},d=["scale","frames","opacity","width","height","blur","far","resolution","smooth","color","depthWrite","renderOrder"],f=s.forwardRef((function(e,r){var t=e.scale,f=void 0===t?10:t,m=e.frames,h=void 0===m?1/0:m,p=e.opacity,g=void 0===p?1:p,y=e.width,x=void 0===y?1:y,w=e.height,b=void 0===w?1:w,E=e.blur,M=void 0===E?1:E,U=e.far,_=void 0===U?10:U,k=e.resolution,D=void 0===k?512:k,S=e.smooth,T=void 0===S||S,L=e.color,P=void 0===L?"#000000":L,j=e.depthWrite,F=void 0!==j&&j,R=e.renderOrder,C=(0,o.Z)(e,d),A=(0,c.w)((function(e){return e.scene})),B=(0,c.w)((function(e){return e.gl})),Z=s.useRef(null);x*=Array.isArray(f)?f[0]:f||1,b*=Array.isArray(f)?f[1]:f||1;var I=s.useMemo((function(){var e=new u.WebGLRenderTarget(D,D),r=new u.WebGLRenderTarget(D,D);r.texture.generateMipmaps=e.texture.generateMipmaps=!1;var t=new u.PlaneBufferGeometry(x,b).rotateX(Math.PI/2),a=new u.Mesh(t),o=new u.MeshDepthMaterial;o.depthTest=o.depthWrite=!1,o.onBeforeCompile=function(e){e.uniforms=(0,n.Z)((0,n.Z)({},e.uniforms),{},{ucolor:{value:new u.Color(P).convertSRGBToLinear()}}),e.fragmentShader=e.fragmentShader.replace("void main() {","uniform vec3 ucolor;\n           void main() {\n          "),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor, ( 1.0 - fragCoordZ ) * 1.0 );")};var i=new u.ShaderMaterial(l),s=new u.ShaderMaterial(v);return s.depthTest=i.depthTest=!1,[e,t,o,a,i,s,r]}),[D,x,b,f,P]),H=(0,a.Z)(I,7),W=H[0],G=H[1],z=H[2],V=H[3],O=H[4],Y=H[5],X=H[6],q=function(e){V.visible=!0,V.material=O,O.uniforms.tDiffuse.value=W.texture,O.uniforms.h.value=1*e/256,B.setRenderTarget(X),B.render(V,Z.current),V.material=Y,Y.uniforms.tDiffuse.value=X.texture,Y.uniforms.v.value=1*e/256,B.setRenderTarget(W),B.render(V,Z.current),V.visible=!1},N=0;return(0,c.x)((function(){if(Z.current&&(h===1/0||N<h)){var e=A.background;A.background=null;var r=A.overrideMaterial;A.overrideMaterial=z,B.setRenderTarget(W),B.render(A,Z.current),A.overrideMaterial=r,q(M),T&&q(.4*M),B.setRenderTarget(null),A.background=e,N++}})),s.createElement("group",(0,i.Z)({"rotation-x":Math.PI/2},C,{ref:r}),s.createElement("mesh",{renderOrder:R,geometry:G,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},s.createElement("meshBasicMaterial",{map:W.texture,"map-encoding":B.outputEncoding,transparent:!0,opacity:g,depthWrite:F})),s.createElement("orthographicCamera",{ref:Z,args:[-x/2,x/2,b/2,-b/2,0,_]}))}))}}]);
//# sourceMappingURL=282.683ddae6.chunk.js.map